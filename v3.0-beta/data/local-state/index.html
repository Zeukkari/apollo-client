<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/apollo-client/styles.0ebae9c4b3c7d4df7946.css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}@font-face{font-family:Source Code Pro;font-style:normal;font-weight:400;src:local("Source Code Pro Regular"),local("SourceCodePro-Regular"),url(https://fonts.gstatic.com/s/sourcecodepro/v11/HI_SiYsKILxRpg3hIP6sJ7fM7PqlPevT.ttf) format("truetype")}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;src:local("Source Sans Pro Regular"),local("SourceSansPro-Regular"),url(https://fonts.gstatic.com/s/sourcesanspro/v13/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7g.ttf) format("truetype")}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;src:local("Source Sans Pro SemiBold"),local("SourceSansPro-SemiBold"),url(https://fonts.gstatic.com/s/sourcesanspro/v13/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwlxdr.ttf) format("truetype")}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}body{font-family:Source Sans Pro,sans-serif}code,pre{font-family:Source Code Pro,monospace}html{font-size:100%;line-height:1.45;overflow-y:auto}body{color:#5a6270}h1,h2,h3,h4,h5,h6,ol,p,ul{margin:0 0 1.45rem}h4,h5{margin-bottom:1.0875rem}h1,h2,h3,h4,h5,h6{line-height:1.1;color:#2f353f}h1,h2,h3,h4,h6{font-weight:400}h1{font-size:2.5rem}h2{font-size:1.73286rem}h3{font-size:1.4427rem}h4,li,p{font-size:1.125rem}h5{font-size:1rem}h6{font-size:.875rem}li,p{line-height:1.7}ol,ul{margin-left:1.45rem;padding:0}li{margin-bottom:.725rem}li>ol,li>ul{margin-top:.725rem}blockquote{margin-left:0;padding:12px 20px;border-left:2px solid #3f20ba}blockquote>p{font-size:inherit}blockquote>p:last-child,form{margin-bottom:0}hr{height:1px;margin-bottom:calc(1.45rem - 1px);border:none;background-color:#dee2e7}img.screenshot{box-shadow:0 0 0 1px rgba(18,21,26,.04),0 1px 4px 0 rgba(0,0,0,.08);border-radius:8px}.gatsby-code-title{display:flex;align-items:center;margin-bottom:-50px;height:50px;font-size:15px;font-family:Source Code Pro,monospace;color:#5a6270;padding-left:19px}.gatsby-highlight-code-line{background-color:#ebeef0;display:block;margin-right:-1em;margin-left:-3.5em;padding-right:1em;padding-left:3.5em}.gatsby-highlight pre[class*=language-]{background-color:transparent;margin:0;padding:0;overflow:initial;float:left;min-width:100%}.gatsby-highlight pre[class*=language-].line-numbers{padding-left:2.5em}.gatsby-highlight pre[class*=language-].line-numbers .line-numbers-rows{border-right:none}.gatsby-highlight pre[class*=language-].line-numbers .line-numbers-rows>span:before{color:#cad0d8}code[class*=language-],pre[class*=language-]{color:#2f353f;font-size:15px;text-shadow:none;font-family:Source Code Pro,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#f4f6f8}:not(pre)>code[class*=language-]{padding:.1em .3em;border-radius:.3em;font-size:.9em;color:#f25cc1;background:#ebeef0}.namespace{opacity:.7}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#959daa}.token.punctuation{color:#5a6270}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#f25cc1}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#26a29d}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:inherit;background:transparent}.token.atrule,.token.attr-value,.token.keyword{color:#3f20ba}.token.class-name,.token.function{color:#f25cc1}.token.important,.token.regex,.token.variable{color:#f4d03f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-]>code[class*=language-],pre[data-line]{position:relative}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}</style><meta name="generator" content="Gatsby 2.18.11"/><title data-react-helmet="true">Local state management - Client (React) - Apollo GraphQL Docs</title><link data-react-helmet="true" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link data-react-helmet="true" rel="icon" href="https://apollographql.com/favicon.ico"/><meta data-react-helmet="true" name="description" content="A guide to using the Apollo GraphQL Client with React"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><meta data-react-helmet="true" property="og:title" content="Local state management"/><meta data-react-helmet="true" property="og:site_name" content="Apollo GraphQL Docs"/><meta data-react-helmet="true" property="og:description" content="Learn how to work with your local data in Apollo Client"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:title" content="Local state management"/><meta data-react-helmet="true" name="twitter:description" content="Learn how to work with your local data in Apollo Client"/><meta data-react-helmet="true" property="og:image" content="/apollo-client/social-cards/local-state.png"/><meta data-react-helmet="true" name="twitter:image" content="https://www.apollographql.com/apollo-client/social-cards/local-state.png"/><meta data-react-helmet="true" name="twitter:site" content="@apollographql"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><script>
      
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics.SNIPPET_VERSION="4.1.0";
    analytics.load('wgrIo8Bul0Ujl8USETG3DB6hONdy4kTg');
    }}();
  
    </script><link as="script" rel="preload" href="/apollo-client/webpack-runtime-db38c7f1b7d41648e3e8.js"/><link as="script" rel="preload" href="/apollo-client/styles-2013ea808de36cd95e02.js"/><link as="script" rel="preload" href="/apollo-client/commons-549c24a093027ad17843.js"/><link as="script" rel="preload" href="/apollo-client/app-30bbb03994201fb9918f.js"/><link as="script" rel="preload" href="/apollo-client/component---node-modules-gatsby-theme-apollo-docs-src-components-template-js-ea9bbb2045f936bba914.js"/><link as="fetch" rel="preload" href="/apollo-client/page-data/v3.0-beta/data/local-state/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><style data-emotion-css="bzzyjq">.css-bzzyjq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;max-width:1440px;margin:0 auto;}</style><div class="css-bzzyjq exdt29b0"><style data-emotion-css="1bs7gxh">.css-1bs7gxh{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:312px;height:100vh;padding:24px;border-right:1px solid #DEE2E7;overflow-y:auto;position:-webkit-sticky;position:sticky;top:0;}@media (max-width:850px){.css-1bs7gxh{height:100%;background-color:white;box-shadow:0 0 48px rgba(0,0,0,0.25);position:fixed;z-index:2;opacity:0;visibility:hidden;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);-webkit-transition-property:-webkit-transform,opacity,visibility;-webkit-transition-property:transform,opacity,visibility;transition-property:transform,opacity,visibility;-webkit-transition-duration:150ms;transition-duration:150ms;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;}}</style><aside class="css-1bs7gxh ezgpdot1"><style data-emotion-css="7ieosi">.css-7ieosi{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:24px;}</style><div class="css-7ieosi ezgpdot2"><style data-emotion-css="gbkvvb">.css-gbkvvb{color:#2F353F;-webkit-text-decoration:none;text-decoration:none;}</style><a href="https://www.apollographql.com/docs/" class="css-gbkvvb ezgpdot3"><style data-emotion-css="k008qs">.css-k008qs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-k008qs eetev6l0"><style data-emotion-css="12zkc8b">.css-12zkc8b{width:64px;height:auto;}</style><style data-emotion-css="80nmto">.css-80nmto{overflow:visible;height:293px;width:64px;height:auto;}.css-80nmto *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 979 293" class="eetev6l1 css-80nmto"><g fill="currentColor" fill-rule="nonzero"><path d="M159.4 83.1H130L87.5 195.4h26.6l6.9-19h40.1l-7.3-21h-26.4l17.2-48.3 30.6 88.4h26.6zM606.3 195.3V83.1H630v91.2h46.6v21zM742.6 195.3V83.1h23.6v91.2h46.6v21zM475.4 103.2c19.5 0 35.5 16.2 35.5 36.1 0 19.9-15.9 36.1-35.5 36.1-19.5 0-35.4-16.2-35.4-36.1 0-19.9 15.9-36.1 35.4-36.1zm0-22c-31.5 0-57 26-57 58.1s25.5 58.1 57 58.1 57-26 57-58.1-25.5-58.1-57-58.1zM921.5 103.2c19.6 0 35.5 16.2 35.5 36.1 0 19.9-15.9 36.1-35.5 36.1-19.5 0-35.4-16.2-35.4-36.1-.1-19.9 15.8-36.1 35.4-36.1zm0-22c-31.5 0-57 26-57 58.1s25.5 58.1 57 58.1 57-26 57-58.1-25.5-58.1-57-58.1zM322 83.1h-51.4v112.3h23.5v-38.6H322c19.6 0 35.5-16.9 35.5-36.8 0-20.1-15.9-36.9-35.5-36.9zm0 51.6h-27.9V105H322c7.7 0 13.9 7 13.9 14.8 0 7.9-6.2 14.9-13.9 14.9z"></path><path d="M250.4 229.4c-2 0-3.8 1-4.9 2.6 0 0-5.3 6.2-8.2 9.1-12.1 12.3-26.1 21.9-41.8 28.7-16.2 7-33.4 10.5-51.2 10.5-17.8 0-35-3.5-51.2-10.5-15.6-6.8-29.7-16.5-41.8-28.8-12.1-12.3-21.6-26.6-28.2-42.6-6.9-16.5-10.3-34-10.3-52.1s3.5-35.6 10.3-52.1c6.6-15.9 16.1-30.3 28.2-42.6 12.1-12.3 26.1-22 41.8-28.7 16.2-7 33.4-10.5 51.2-10.5 17.8 0 35 3.5 51.2 10.5 11.4 4.9 22 11.4 31.5 19.3-.5 1.5-.8 3.2-.8 4.9 0 8.3 6.6 15.1 14.8 15.1 8.2 0 14.8-6.8 14.8-15.1S249.2 32 241 32c-2 0-4 .4-5.7 1.2C210.5 12.5 178.8.1 144.3.1 65 .2.7 65.6.7 146.4c0 80.8 64.3 146.2 143.6 146.2 44.4 0 84-20.5 110.4-52.7 1.1-1.1 1.8-2.7 1.8-4.4-.1-3.4-2.8-6.1-6.1-6.1z"></path></g></svg><style data-emotion-css="1ecj0ix">.css-1ecj0ix{margin-left:6px;margin-top:1px;height:16px;}</style><svg width="48" height="16" class="css-1ecj0ix eetev6l2"><path d="M2.564 0h42.192c.892 0 1.215.093 1.54.267.327.174.583.43.757.756.174.326.267.65.267 1.54v10.873c0 .892-.093 1.215-.267 1.54-.174.327-.43.583-.756.757-.326.174-.65.267-1.54.267H2.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 01-.757-.756C.093 14.65 0 14.327 0 13.437V2.563c0-.892.093-1.215.267-1.54.174-.327.43-.583.756-.757C1.35.093 1.673 0 2.563 0z" fill="#ebe6ff"></path><g fill="#3f20ba"><path d="M6.893 4.363c2.299 0 3.894 1.463 3.894 3.663 0 2.222-1.595 3.674-3.883 3.674H4V4.363zm.011 1.375H5.562v4.587h1.331c1.452 0 2.299-1.045 2.299-2.299 0-1.287-.792-2.288-2.288-2.288zM30.477 11.832c1.606 0 2.541-.891 3.058-1.804l-1.342-.649c-.308.594-.968 1.067-1.716 1.067-1.342 0-2.31-1.023-2.31-2.409s.968-2.409 2.31-2.409c.748 0 1.408.473 1.716 1.067l1.342-.66c-.517-.924-1.452-1.793-3.058-1.793-2.211 0-3.916 1.529-3.916 3.795 0 2.255 1.705 3.795 3.916 3.795zM40.388 11.832c1.969 0 2.937-1.012 2.937-2.354 0-2.739-4.213-1.958-4.213-3.113 0-.44.374-.726 1.034-.726.748 0 1.54.253 2.134.803l.869-1.166c-.726-.671-1.694-1.023-2.86-1.023-1.727 0-2.783 1.012-2.783 2.233 0 2.761 4.224 1.87 4.224 3.146 0 .429-.407.814-1.276.814a3.224 3.224 0 01-2.332-1.001l-.858 1.221c.693.693 1.705 1.166 3.124 1.166zM18.715 5.682c1.278 0 2.314 1.061 2.314 2.365 0 1.304-1.036 2.366-2.314 2.366-1.27 0-2.307-1.062-2.307-2.366-.007-1.304 1.03-2.365 2.307-2.365zm0-1.442C16.662 4.24 15 5.944 15 8.047c0 2.104 1.662 3.807 3.715 3.807s3.715-1.703 3.715-3.807c0-2.103-1.662-3.807-3.715-3.807z"></path></g></svg></div></a></div><div class="sidebar"><style data-emotion-css="4ddkzq">.css-4ddkzq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:32px;}</style><span class="css-4ddkzq efh8xek5"><style data-emotion-css="i9gxme">.css-i9gxme{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="css-i9gxme efh8xek1"><style data-emotion-css="3lqork">.css-3lqork{width:100%;}.css-3lqork:not(:hover){background-color:#F4F6F8;}</style><style data-emotion-css="1gl03rw dtw560">.css-1gl03rw{background-color:transparent;border-radius:4px;border-width:0;color:#3f20ba;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:28px;min-width:76px;padding:0 12px;font-family:'Source Sans Pro',sans-serif;font-size:13px;line-height:1.54;font-weight:600;outline:0;-webkit-text-decoration:none;text-decoration:none;white-space:nowrap;}.css-1gl03rw[disabled],.css-1gl03rw[disabled]:hover{background-color:transparent;box-shadow:none;color:#959DAA;}.css-1gl03rw:hover,.css-1gl03rw[data-force-hover-state]{background-color:#ebe6ff;color:#3f20ba;}.css-1gl03rw:focus,.css-1gl03rw[data-force-focus-state]{background-color:#ffffff;color:#2075d6;box-shadow:0 1px 4px 0 rgba(18,21,26,0.08),0 0 0 2px #bbdbff,inset 0 0 0 1px #311c87,inset 0 -1px 0 0 rgba(18,21,26,0.05);}.css-1gl03rw:active,.css-1gl03rw[data-force-active-state]{color:#3f20ba;background-color:#ad9bf6;box-shadow:none;outline:0;}.css-dtw560{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}</style><button style="display:block" class="css-3lqork efh8xek2 css-1gl03rw"><div class="css-dtw560"><span class="title-sidebar">Client (React)</span><style data-emotion-css="1fs6g1o">.css-1fs6g1o{height:16px;width:16px;margin-left:auto;}</style><style data-emotion-css="1rnfna3">.css-1rnfna3{overflow:visible;height:24px;height:16px;width:16px;margin-left:auto;}.css-1rnfna3 *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 24 24" class="efh8xek3 css-1rnfna3"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M2.25.747h6a1.5 1.5 0 0 1 1.5 1.5v6a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5v-6a1.5 1.5 0 0 1 1.5-1.5zM2.25 14.247h6a1.5 1.5 0 0 1 1.5 1.5v6a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5v-6a1.5 1.5 0 0 1 1.5-1.5zM15.75.747h6a1.5 1.5 0 0 1 1.5 1.5v6a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5v-6a1.5 1.5 0 0 1 1.5-1.5zM15.75 14.247h6a1.5 1.5 0 0 1 1.5 1.5v6a1.5 1.5 0 0 1-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5v-6a1.5 1.5 0 0 1 1.5-1.5z"></path></g></svg></div></button></div><style data-emotion-css="79elbk">.css-79elbk{position:relative;}</style><div class="css-79elbk e1azhpec0" style="margin-left:8px"><style data-emotion-css="1pl2i23 dtw560">.css-1pl2i23{background-color:transparent;border-radius:4px;border-width:0;color:#424855;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:28px;min-width:76px;padding:0 12px;font-family:'Source Sans Pro',sans-serif;font-size:13px;line-height:1.54;font-weight:600;outline:0;-webkit-text-decoration:none;text-decoration:none;white-space:nowrap;}.css-1pl2i23[disabled],.css-1pl2i23[disabled]:hover{background-color:transparent;box-shadow:none;color:#959DAA;}.css-1pl2i23:hover,.css-1pl2i23[data-force-hover-state]{background-color:#F4F6F8;color:#424855;}.css-1pl2i23:focus,.css-1pl2i23[data-force-focus-state]{background-color:#ffffff;color:#2075d6;box-shadow:0 1px 4px 0 rgba(18,21,26,0.08),0 0 0 2px #bbdbff,inset 0 0 0 1px #2075d6,inset 0 -1px 0 0 rgba(18,21,26,0.05);}.css-1pl2i23:active,.css-1pl2i23[data-force-active-state]{color:#424855;background-color:#EBEEF0;box-shadow:none;outline:0;}</style><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><style data-emotion-css="gyp8mm">.css-gyp8mm{visibility:hidden;}</style><div class="css-gyp8mm e1azhpec5">v2.6</div><div class="css-gyp8mm e1azhpec5">v3.0 beta</div><div class="css-gyp8mm e1azhpec5">v2.5</div><div class="css-gyp8mm e1azhpec5">v2.4</div><style data-emotion-css="v0jgcu">.css-v0jgcu{position:absolute;top:0;left:0;}</style><div class="css-v0jgcu e1azhpec6">v3.0 beta</div></div><style data-emotion-css="jubejm">.css-jubejm{height:1em;width:1em;margin-left:12px;}</style><style data-emotion-css="xdptra">.css-xdptra{overflow:visible;height:24px;height:1em;width:1em;margin-left:12px;}.css-xdptra *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div></span><style data-emotion-css="qomam7">.css-qomam7{margin-left:0;list-style:none;margin-bottom:32px;}</style><ul class="css-qomam7 emu0m580"><style data-emotion-css="s6dc9k">.css-s6dc9k{font-size:1rem;line-height:1.5;margin-bottom:0.8125rem;}.css-s6dc9k a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-s6dc9k a:hover{opacity:0.8;}.css-s6dc9k a.active{color:#3f20ba;pointer-events:none;}</style><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/">Introduction</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/why-apollo/">Why Apollo Client?</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/get-started/">Get started</a></li></ul><style data-emotion-css="av9mjd">.css-av9mjd{color:inherit;-webkit-letter-spacing:0.142em;-moz-letter-spacing:0.142em;-ms-letter-spacing:0.142em;letter-spacing:0.142em;text-transform:uppercase;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:12px;padding:4px 0;border:0;font-size:12px;font-weight:600;line-height:1;background:none;outline:none;cursor:pointer;}.css-av9mjd:hover{opacity:0.8;}.css-av9mjd svg{height:12px;width:12px;margin-right:8px;}</style><button class="css-av9mjd emu0m582"><style data-emotion-css="10zhkrl">.css-10zhkrl{overflow:visible;height:24px;}.css-10zhkrl *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 24 24" class="css-10zhkrl"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M3.75 15l7.72 7.72a.75.75 0 0 0 1.06 0L20.25 15M3.75 9l7.72-7.72a.749.749 0 0 1 1.059-.001l.001.001L20.25 9"></path></g></svg>Expand<!-- --> all</button><div><style data-emotion-css="4e6zf">.css-4e6zf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;border:0;padding:0.75em 0;color:#2F353F;background:none;outline:none;}.css-4e6zf h6{margin:0;font-weight:bold;-webkit-letter-spacing:0.142em;-moz-letter-spacing:0.142em;-ms-letter-spacing:0.142em;letter-spacing:0.142em;text-transform:uppercase;color:inherit;}.css-4e6zf svg{display:block;width:10px;height:10px;margin-left:auto;fill:currentColor;}.css-4e6zf.active{color:#3f20ba;}.css-4e6zf:not([disabled]){cursor:pointer;}.css-4e6zf:not([disabled]):hover{opacity:0.8;}</style><button class="active css-4e6zf eurzk6o0"><h6>Fetching data</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M.75 17.189L11.47 6.47a.749.749 0 0 1 1.059-.001l.001.001 10.72 10.719"></path></svg></button><ul class="css-qomam7 emu0m580"><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/data/queries/">Queries</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/data/mutations/">Mutations</a></li><li class="css-s6dc9k emu0m581"><a aria-current="page" class="active" href="/apollo-client/v3.0-beta/data/local-state/">Local state management</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/data/subscriptions/">Subscriptions</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/data/pagination/">Pagination</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/data/fragments/">Fragments</a></li><li class="css-s6dc9k emu0m581"><a href="/apollo-client/v3.0-beta/data/error-handling/">Error handling</a></li></ul></div><div><button class="false css-4e6zf eurzk6o0"><h6>Caching</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div><div><button class="false css-4e6zf eurzk6o0"><h6>Development &amp; Testing</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div><div><button class="false css-4e6zf eurzk6o0"><h6>Performance</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div><div><button class="false css-4e6zf eurzk6o0"><h6>Integrations</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div><div><button class="false css-4e6zf eurzk6o0"><h6>Networking</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div><div><button class="false css-4e6zf eurzk6o0"><h6>Apollo Client API</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div><div><button class="false css-4e6zf eurzk6o0"><h6>Migrating</h6><svg viewBox="0 0 24 24" style="visibility:visible" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></button></div></div></aside><main class="css-i9gxme efh8xek0"><style data-emotion-css="o3chs1">.css-o3chs1{position:-webkit-sticky;position:sticky;top:0;left:0;z-index:1;}</style><header class="css-o3chs1 edldhn50"><style data-emotion-css="18fgwiw">.css-18fgwiw{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;padding:8px 56px;background-color:#F4F6F8;color:#3f20ba;font-size:14px;position:-webkit-sticky;position:sticky;top:0;}.css-18fgwiw a{color:inherit;font-weight:600;}@media (max-width:850px){.css-18fgwiw{padding:8px 24px;}}</style><div class="css-18fgwiw efh8xek6">You&#x27;re viewing documentation for a<!-- --> <!-- -->version of this software that is in development<!-- -->. <a href="/apollo-client/">Switch to the latest stable version</a></div><style data-emotion-css="kdqfuf">.css-kdqfuf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:64px;padding:0 56px;background-color:white;}@media (max-width:850px){.css-kdqfuf{padding:0 24px;}}</style><div class="css-kdqfuf edldhn51"><style data-emotion-css="8jbk1d">.css-8jbk1d{display:none;}@media (max-width:850px){.css-8jbk1d{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:32px;color:#2F353F;}}</style><div class="css-8jbk1d efh8xek4"><style data-emotion-css="y6f8an">.css-y6f8an{padding:0;margin-right:20px;color:inherit;border:none;background:none;outline:none;cursor:pointer;}</style><button class="css-y6f8an e1qf1exz0"><style data-emotion-css="1ihqbbj">.css-1ihqbbj{height:24px;width:24px;display:block;fill:currentColor;}</style><style data-emotion-css="19ilpbi">.css-19ilpbi{overflow:visible;height:24px;height:24px;width:24px;display:block;fill:currentColor;}.css-19ilpbi *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 24 24" class="e1qf1exz1 css-19ilpbi"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M2.25 18.003h19.5M2.25 12.003h19.5M2.25 6.003h19.5"></path></g></svg></button><svg viewBox="0 0 200 200" width="32" fill="currentColor"><path d="M112.246 49H88.003L53 139.848h21.927l5.721-15.393h33.076l-5.989-17.024H85.961l14.164-39.091 25.199 71.508h21.928z"></path><path d="M196.313 73.038a4.991 4.991 0 00-.256-.897c-.027-.1-.12-.285-.12-.285a4.993 4.993 0 00-4.538-2.914 5 5 0 00-5 5c0 .562.098 1.1.268 1.603l-.014.005a90.354 90.354 0 013.346 24.451c0 24.039-9.362 46.641-26.359 63.64-16.999 17-39.6 26.36-63.64 26.36-24.039 0-46.642-9.362-63.639-26.36C19.36 146.642 10 124.04 10 100.001c0-24.04 9.362-46.641 26.361-63.64 16.997-17 39.6-26.36 63.639-26.36 21.466 0 41.781 7.47 57.987 21.173a12.218 12.218 0 00-.848 4.474c0 6.751 5.472 12.221 12.224 12.221 6.75 0 12.223-5.47 12.223-12.221s-5.473-12.224-12.223-12.224c-1.473 0-2.884.26-4.192.737C147.666 9.107 124.9 0 100 0 44.771 0 0 44.772 0 100.001c0 55.229 44.771 100.001 100 100.001s100-44.771 100-100.001c0-9.342-1.291-18.384-3.687-26.963z"></path></svg></div><style data-emotion-css="2sza2b">.css-2sza2b{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;visibility:hidden;background-color:rgba(90,98,112,0.5);-webkit-transition-property:opacity,visibility;transition-property:opacity,visibility;-webkit-transition-duration:150ms;transition-duration:150ms;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;z-index:1;}</style><div class="css-2sza2b e1vsvaua3"></div><style data-emotion-css="1kblkc9">.css-1kblkc9{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;margin-right:40px;color:#5A6270;position:relative;z-index:1;}@media (max-width:850px){.css-1kblkc9{margin-right:0;}}.css-1kblkc9 .algolia-autocomplete{width:100%;}.css-1kblkc9 .algolia-autocomplete .ds-dropdown-menu{width:100%;max-width:100%;min-width:auto;margin-top:14px;border-radius:5px;box-shadow:rgba(0,0,0,0.1) 0 2px 12px;}.css-1kblkc9 .algolia-autocomplete .ds-dropdown-menu::before{display:none;}.css-1kblkc9 .algolia-autocomplete .ds-dropdown-menu [class^=ds-dataset-]{max-height:calc(100vh - 64px - 32px);padding:0;border:1px solid #959DAA;border-radius:inherit;}.css-1kblkc9 .algolia-autocomplete .ds-dropdown-menu .ds-suggestions{margin-top:0;}.css-1kblkc9 .algolia-autocomplete .ds-dropdown-menu .ds-suggestion{padding:20px 32px;border-bottom:1px solid #DEE2E7;}.css-1kblkc9 .algolia-autocomplete .ds-dropdown-menu .ds-suggestion.ds-cursor{background-color:rgba(222,226,231,0.5);}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion{padding:0;color:inherit;background:none;-webkit-text-decoration:none;text-decoration:none;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--wrapper,.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--subcategory-column,.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--content{width:auto;float:none;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--wrapper{padding-top:0;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--category-header{margin-top:0;margin-bottom:4px;border-bottom:0;font-size:14px;color:inherit;-webkit-letter-spacing:0.142em;-moz-letter-spacing:0.142em;-ms-letter-spacing:0.142em;letter-spacing:0.142em;text-transform:uppercase;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--subcategory-column,.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--content{padding:0;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--subcategory-column::before,.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--content::before{display:none;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--subcategory-column{margin-bottom:4px;font-size:22px;color:#2F353F;text-align:initial;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--content{background:none !important;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--title{margin-bottom:0;font-size:18px;font-weight:normal;color:inherit;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--highlight{box-shadow:none !important;color:#3f20ba !important;background:none !important;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-suggestion--no-results{padding:32px;}.css-1kblkc9 .algolia-autocomplete .algolia-docsearch-footer{margin:12px;}</style><div class="css-1kblkc9 e1vsvaua1"><style data-emotion-css="1es5zjy">.css-1es5zjy{width:100%;height:42px;padding:0;padding-left:16px;border:1px solid #959DAA;border-radius:5px;box-shadow:none;font-size:16px;background:white;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;}</style><input id="input" value="" placeholder="Search Apollo Docs" class="css-1es5zjy e1vsvaua2"/><style data-emotion-css="knt3s7">.css-knt3s7{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);height:24px;width:24px;border:1px solid #959DAA;border-color:#CAD0D8;color:#CAD0D8;border-radius:5px;text-align:center;line-height:1.125;right:10px;pointer-events:none;}</style><div class="css-knt3s7 e1vsvaua0">/</div></div><style data-emotion-css="3gq4g2">.css-3gq4g2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:240px;}@media (max-width:1120px){.css-3gq4g2{width:auto;margin-right:0;}}@media (max-width:850px){.css-3gq4g2{display:none;}}</style><div class="css-3gq4g2 e1nk4tvb0"><style data-emotion-css="1aihuhw">.css-1aihuhw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#3f20ba;line-height:2;-webkit-text-decoration:none;text-decoration:none;}.css-1aihuhw:hover{color:#311c87;}</style><a href="https://engine.apollographql.com?utm_source=docs-button" target="_blank" rel="noopener noreferrer" class="css-1aihuhw e1nk4tvb1">Launch Graph Manager<style data-emotion-css="lrbhy3">.css-lrbhy3{height:0.75em;margin-left:0.5em;}</style><style data-emotion-css="1rvg6qe">.css-1rvg6qe{overflow:visible;height:24px;height:0.75em;margin-left:0.5em;}.css-1rvg6qe *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 24 24" class="e1nk4tvb2 css-1rvg6qe"><g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"><path d="M.75 12h22.5M12.75 1.5L23.25 12l-10.5 10.5"></path></g></svg></a></div></div></header><style data-emotion-css="ifkzhd">.css-ifkzhd{padding:40px 56px;padding-bottom:0;}@media (max-width:850px){.css-ifkzhd{padding:32px 48px;}}@media (max-width:600px){.css-ifkzhd{padding:24px 32px;}}</style><div class="css-ifkzhd ernxcdh0"><div class="header-wrapper"><style data-emotion-css="cz947x">.css-cz947x:not(:last-child){margin-bottom:8px;}</style><h1 class="css-cz947x ei8t6h40">Local state management</h1><style data-emotion-css="kfq87l">.css-kfq87l{color:#5A6270;}</style><h3 class="css-kfq87l ei8t6h41">Learn how to work with your local data in Apollo Client</h3></div><hr/><style data-emotion-css="1yp4ln">.css-1yp4ln{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}</style><div class="css-1yp4ln e694h6z0"><style data-emotion-css="j4wukh">.css-j4wukh{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;width:0;}</style><div class="css-j4wukh e694h6z1"><style data-emotion-css="n5xruk">.css-n5xruk a[href]:not([class]){color:#3f20ba;-webkit-text-decoration:none;text-decoration:none;}.css-n5xruk a[href]:not([class]):hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-n5xruk a[href]:not([class]) code{color:inherit;}.css-n5xruk h1[id]::before,.css-n5xruk h2[id]::before,.css-n5xruk h3[id]::before,.css-n5xruk h4[id]::before,.css-n5xruk h5[id]::before,.css-n5xruk h6[id]::before{content:'';display:block;margin-top:-64px;height:64px;visibility:hidden;pointer-events:none;}.css-n5xruk h1:not(:hover) a svg,.css-n5xruk h2:not(:hover) a svg,.css-n5xruk h3:not(:hover) a svg,.css-n5xruk h4:not(:hover) a svg,.css-n5xruk h5:not(:hover) a svg,.css-n5xruk h6:not(:hover) a svg{visibility:hidden;}.css-n5xruk h1 a.anchor:hover,.css-n5xruk h2 a.anchor:hover,.css-n5xruk h3 a.anchor:hover,.css-n5xruk h4 a.anchor:hover,.css-n5xruk h5 a.anchor:hover,.css-n5xruk h6 a.anchor:hover{opacity:0.8;}.css-n5xruk h1 a.anchor svg,.css-n5xruk h2 a.anchor svg,.css-n5xruk h3 a.anchor svg,.css-n5xruk h4 a.anchor svg,.css-n5xruk h5 a.anchor svg,.css-n5xruk h6 a.anchor svg{fill:#3f20ba;}.css-n5xruk h2:not(:first-child),.css-n5xruk h3:not(:first-child),.css-n5xruk h4:not(:first-child){margin-top:56px;}.css-n5xruk img{display:block;max-width:100%;margin:0 auto;}</style><div class="content-wrapper css-n5xruk e694h6z2"><p>We&#x27;ve learned how to manage remote data from our GraphQL server with Apollo Client, but what should we do with our local data? We want to be able to access boolean flags and device API results from multiple components in our app, but don&#x27;t want to maintain a separate Redux or MobX store. Ideally, we would like the Apollo cache to be the single source of truth for all data in our client application.</p><p>Apollo Client (&gt;= 2.5) has built-in local state handling capabilities that allow you to store your local data inside the Apollo cache alongside your remote data. To access your local data, just query it with GraphQL. You can even request local and server data within the same query!</p><p>In this section, you&#x27;ll learn how Apollo Client can help simplify local state management in your app. We&#x27;ll cover how client-side resolvers can help us execute local queries and mutations. You&#x27;ll also learn how to query and update the cache with the <code class="language-text">@client</code> directive.</p><p>Please note that this documentation is intended to be used to familiarize yourself with Apollo Client&#x27;s local state management capabilities, and serve as a reference guide. If you&#x27;re looking for a step by step tutorial outlining how to handle local state with Apollo Client (and leverage other Apollo components to build a fullstack application), please refer to the <a href="https://www.apollographql.com/docs/tutorial/introduction">Apollo tutorial</a>.</p><blockquote><p>⚠️ If you&#x27;re interested in integrating local state handling capabilities with Apollo Client &lt; 2.5, please refer to our (now deprecated) <a href="https://github.com/apollographql/apollo-link-state" target="_blank" rel="noopener noreferrer"><code class="language-text">apollo-link-state</code></a> project. As of Apollo Client 2.5, local state handling is baked into the core, which means it is no longer necessary to use <code class="language-text">apollo-link-state</code>. For help migrating from <code class="language-text">apollo-link-state</code> to Apollo Client 2.5, please refer to the <a href="#migrating-from-apollo-link-state">Migrating from <code class="language-text">apollo-link-state</code></a> section.</p></blockquote><h2 id="updating-local-state"><a href="#updating-local-state" aria-label="updating local state permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Updating local state</h2><p>There are two main ways to perform local state mutations. The first way is to directly write to the cache by calling <code class="language-text">cache.writeData</code>. Direct writes are great for one-off mutations that don&#x27;t depend on the data that&#x27;s currently in the cache, such as writing a single value. The second way is by leveraging the <code class="language-text">useMutation</code> hook with a GraphQL mutation that calls a local client-side resolver. We recommend using resolvers if your mutation depends on existing values in the cache, such as adding an item to a list or toggling a boolean.</p><h3 id="direct-writes"><a href="#direct-writes" aria-label="direct writes permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Direct writes</h3><p>Direct writes to the cache do not require a GraphQL mutation or a resolver function. They leverage your Apollo Client instance directly by accessing the <code class="language-text">client</code> property returned from the <code class="language-text">useApolloClient</code> hook, made available in the <code class="language-text">useQuery</code> hook result, or within the render prop function of the <code class="language-text">ApolloConsumer</code> component. We recommend using this strategy for simple writes, such as writing a string, or one-off writes. It&#x27;s important to note that direct writes are not implemented as GraphQL mutations under the hood, so you shouldn&#x27;t include them in your schema. They also do not validate that the data you&#x27;re writing to the cache is in the shape of valid GraphQL data. If either of these features are important to you, you should opt to use a local resolver instead.</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="jsx"><style data-emotion-css="1gcd36t">.css-1gcd36t{margin-bottom:1.45rem;border:1px solid #DEE2E7;border-radius:4px;}</style><div class="css-1gcd36t e1ulzjg70"><style data-emotion-css="j1ow3a">.css-j1ow3a{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;padding:10px;border-bottom:1px solid #DEE2E7;}</style><div class="css-j1ow3a e1ulzjg71"><style data-emotion-css="12z0wuy">.css-12z0wuy{margin-right:8px;}</style><style data-emotion-css="1mux1e8">.css-1mux1e8{position:relative;margin-right:8px;}</style><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><style data-emotion-css="r8v8pb">.css-r8v8pb{padding:15px;background-color:#F4F6F8;overflow:auto;}</style><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useApolloClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">&quot;./Link&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">FilterLink</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> filter<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token function">useApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Link</span></span>
      <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> client<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span> visibilityFilter<span class="token punctuation">:</span> filter <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Link</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>The <code class="language-text">ApolloConsumer</code> render prop function is called with a single value, the Apollo Client instance. You can think of the <code class="language-text">ApolloConsumer</code> component as being similar to the <code class="language-text">Consumer</code> component from the <a href="https://reactjs.org/docs/context.html" target="_blank" rel="noopener noreferrer">React context API</a>. From the client instance, you can directly call <code class="language-text">client.writeData</code> and pass in the data you&#x27;d like to write to the cache.</p><p>What if we want to immediately subscribe to the data we just wrote to the cache? Let&#x27;s create an <code class="language-text">active</code> property on the link that marks the link&#x27;s filter as active if it&#x27;s the same as the current <code class="language-text">visibilityFilter</code> in the cache. To immediately subscribe to a client-side mutation, we can use <code class="language-text">useQuery</code>. The <code class="language-text">useQuery</code> hook also makes the client instance available in its result object.</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="jsx"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> gql<span class="token punctuation">,</span> useQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">&quot;./Link&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">GET_VISIBILITY_FILTER</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  {
    visibilityFilter @client
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">FilterLink</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> filter<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> client <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">GET_VISIBILITY_FILTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Link</span></span>
      <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> client<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span> visibilityFilter<span class="token punctuation">:</span> filter <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">active</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>visibilityFilter <span class="token operator">===</span> filter<span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Link</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>You&#x27;ll notice in our query that we have a <code class="language-text">@client</code> directive next to our <code class="language-text">visibilityFilter</code> field. This tells Apollo Client to fetch the field data locally (either from the cache or using a local resolver), instead of sending it to our GraphQL server. Once you call <code class="language-text">client.writeData</code>, the query result on the render prop function will automatically update. All cache writes and reads are synchronous, so you don&#x27;t have to worry about loading state.</p><h3 id="local-resolvers"><a href="#local-resolvers" aria-label="local resolvers permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Local resolvers</h3><p>If you&#x27;d like to implement your local state update as a GraphQL mutation, then you&#x27;ll need to specify a function in your local resolver map. The resolver map is an object with resolver functions for each GraphQL object type. To visualize how this all lines up, it&#x27;s useful to think of a GraphQL query or mutation as a tree of function calls for each field. These function calls resolve to data or another function call. So when a GraphQL query is run through Apollo Client, it looks for a way to essentially run functions for each field in the query. When it finds an <code class="language-text">@client</code> directive on a field, it turns to its internal resolver map looking for a function it can run for that field.</p><p>To help make local resolvers more flexible, the signature of a resolver function is the exact same as resolver functions on the server built with <a href="https://www.apollographql.com/docs/apollo-server/essentials/data">Apollo Server</a>. Let&#x27;s recap the four parameters of a resolver function:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token function-variable function">fieldName</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> args<span class="token punctuation">,</span> context<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> result<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span></span></pre></div></div></div><ol><li><code class="language-text">obj</code>: The object containing the result returned from the resolver on the parent field or the <code class="language-text">ROOT_QUERY</code> object in the case of a top-level query or mutation.</li><li><code class="language-text">args</code>: An object containing all of the arguments passed into the field. For example, if you called a mutation with <code class="language-text">updateNetworkStatus(isConnected: true)</code>, the <code class="language-text">args</code> object would be <code class="language-text">{ isConnected: true }</code>.</li><li><code class="language-text">context</code>: An object of contextual information shared between your React components and your Apollo Client network stack. In addition to any custom context properties that may be present, local resolvers always receive the following:<ul><li><code class="language-text">context.client</code>: The Apollo Client instance.</li><li><code class="language-text">context.cache</code>: The Apollo Cache instance, which can be used to manipulate the cache with <code class="language-text">context.cache.readQuery</code>, <code class="language-text">.writeQuery</code>, <code class="language-text">.readFragment</code>, <code class="language-text">.writeFragment</code>, and <code class="language-text">.writeData</code>. You can learn more about these methods in <a href="#managing-the-cache">Managing the cache</a>.</li><li><code class="language-text">context.getCacheKey</code>: Get a key from the cache using a <code class="language-text">__typename</code> and <code class="language-text">id</code>.</li></ul></li><li><code class="language-text">info</code>: Information about the execution state of the query. You will probably never have to use this one.</li></ol><p>Let&#x27;s take a look at an example of a resolver where we toggle a todo&#x27;s completed status:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Mutation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">toggleTodo</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_root<span class="token punctuation">,</span> variables<span class="token punctuation">,</span> <span class="token punctuation">{</span> cache<span class="token punctuation">,</span> getCacheKey <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">getCacheKey</span><span class="token punctuation">(</span><span class="token punctuation">{</span> __typename<span class="token punctuation">:</span> <span class="token string">&#x27;TodoItem&#x27;</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> variables<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> fragment <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
          fragment completeTodo on TodoItem {
            completed
          }
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> todo <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">readFragment</span><span class="token punctuation">(</span><span class="token punctuation">{</span> fragment<span class="token punctuation">,</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>todo<span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>In order to toggle the todo&#x27;s completed status, we first need to query the cache to find out what the todo&#x27;s current completed status is. We do this by reading a fragment from the cache with <code class="language-text">cache.readFragment</code>. This function takes a fragment and an id, which corresponds to the todo item&#x27;s cache key. We get the cache key by calling the <code class="language-text">getCacheKey</code> that&#x27;s on the context and passing in the item&#x27;s <code class="language-text">__typename</code> and <code class="language-text">id</code>.</p><p>Once we read the fragment, we toggle the todo&#x27;s completed status and write the updated data back to the cache. Since we don&#x27;t plan on using the mutation&#x27;s return result in our UI, we return null since all GraphQL types are nullable by default.</p><p>Let&#x27;s learn how to trigger our <code class="language-text">toggleTodo</code> mutation from our component:</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="jsx"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> gql<span class="token punctuation">,</span> useMutation <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">TOGGLE_TODO</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  mutation ToggleTodo($id: Int!) {
    toggleTodo(id: $id) @client
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Todo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id<span class="token punctuation">,</span> completed<span class="token punctuation">,</span> text <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>toggleTodo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMutation</span><span class="token punctuation">(</span><span class="token constant">TOGGLE_TODO</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> variables<span class="token punctuation">:</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span>
      <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>toggleTodo<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        textDecoration<span class="token punctuation">:</span> completed <span class="token operator">?</span> <span class="token string">&quot;line-through&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>First, we create a GraphQL mutation that takes the todo&#x27;s id we want to toggle as its only argument. We indicate that this is a local mutation by marking the field with a <code class="language-text">@client</code> directive. This will tell Apollo Client to call our local <code class="language-text">toggleTodo</code> mutation resolver in order to resolve the field. Then, we create a component with <code class="language-text">useMutation</code> just as we would for a remote mutation. Finally, pass in your GraphQL mutation to your component and trigger it from within the UI in your render prop function.</p><h2 id="querying-local-state"><a href="#querying-local-state" aria-label="querying local state permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Querying local state</h2><p>Querying for local data is very similar to querying your GraphQL server. The only difference is that you add a <code class="language-text">@client</code> directive on your local fields to indicate they should be resolved from the Apollo Client cache or a local resolver function. Let&#x27;s look at an example:</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="jsx"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> gql<span class="token punctuation">,</span> useQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Todo <span class="token keyword">from</span> <span class="token string">&quot;./Todo&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">GET_TODOS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  {
    todos @client {
      id
      completed
      text
    }
    visibilityFilter @client
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">TodoList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span> todos<span class="token punctuation">,</span> visibilityFilter <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">GET_TODOS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token function">getVisibleTodos</span><span class="token punctuation">(</span>todos<span class="token punctuation">,</span> visibilityFilter<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Todo</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">todo</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>Here we create our GraphQL query and add <code class="language-text">@client</code> directives to <code class="language-text">todos</code> and <code class="language-text">visibilityFilter</code>. We then pass the query to the <code class="language-text">useQuery</code> hook. The <code class="language-text">@client</code> directives here let <code class="language-text">useQuery</code> component know that <code class="language-text">todos</code> and <code class="language-text">visibilityFilter</code> should be pulled from the Apollo Client cache or resolved using pre-defined local resolvers. The following sections help explain how both options work in more detail.</p><blockquote><p>⚠️ Since the above query runs as soon as the component is mounted, what do we do if there are no todos in the cache or there aren&#x27;t any local resolvers defined to help calculate <code class="language-text">todos</code>? We need to write an initial state to the cache before the query is run to prevent it from erroring out. Refer to the <a href="#initializing-the-cache">Initializing the cache</a> section below for more information.</p></blockquote><h3 id="initializing-the-cache"><a href="#initializing-the-cache" aria-label="initializing the cache permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initializing the cache</h3><p>Often, you&#x27;ll need to write an initial state to the cache so any components querying data before a mutation is triggered don&#x27;t error out. To accomplish this, you can use <code class="language-text">cache.writeData</code> to prep the cache with initial values. The shape of your initial state should match how you plan to query it in your application.</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    todos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    visibilityFilter<span class="token punctuation">:</span> <span class="token string">&#x27;SHOW_ALL&#x27;</span><span class="token punctuation">,</span>
    networkStatus<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      __typename<span class="token punctuation">:</span> <span class="token string">&#x27;NetworkStatus&#x27;</span><span class="token punctuation">,</span>
      isConnected<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>Sometimes you may need to <a href="/apollo-client/v3.0-beta/api/core/#ApolloClient.resetStore">reset the store</a> in your application, when a user logs out for example. If you call <code class="language-text">client.resetStore</code> anywhere in your application, you will likely want to initialize your cache again. You can do this using the <code class="language-text">client.onResetStore</code> method to register a callback that will call <code class="language-text">cache.writeData</code> again.</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  todos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  visibilityFilter<span class="token punctuation">:</span> <span class="token string">&#x27;SHOW_ALL&#x27;</span><span class="token punctuation">,</span>
  networkStatus<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    __typename<span class="token punctuation">:</span> <span class="token string">&#x27;NetworkStatus&#x27;</span><span class="token punctuation">,</span>
    isConnected<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">onResetStore</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><h3 id="local-data-query-flow"><a href="#local-data-query-flow" aria-label="local data query flow permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Local data query flow</h3><p>When a query containing <code class="language-text">@client</code> directives is executed, Apollo Client runs through a few sequential steps to try to find a result for the <code class="language-text">@client</code> field. Let&#x27;s use the following query to walk through the local data look up flow:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> <span class="token constant">GET_LAUNCH_DETAILS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query LaunchDetails($launchId: ID!) {
    launch(id: $launchId) {
      isInCart @client
      site
      rocket {
        type
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>This query includes a mixture of both remote and local fields. <code class="language-text">isInCart</code> is the only field marked with an <code class="language-text">@client</code> directive, so it&#x27;s the field we&#x27;ll focus on. When Apollo Client executes this query and tries to find a result for the <code class="language-text">isInCart</code> field, it runs through the following steps:</p><ol><li>Has a resolver function been set (either through the <code class="language-text">ApolloClient</code> constructor <code class="language-text">resolvers</code> parameter or Apollo Client&#x27;s <code class="language-text">setResolvers</code> / <code class="language-text">addResolvers</code> methods) that is associated with the field name <code class="language-text">isInCart</code>? If yes, run and return the result from the resolver function.</li><li>If a matching resolver function can&#x27;t be found, check the Apollo Client cache to see if a <code class="language-text">isInCart</code> value can be found directly. If so, return that value.</li></ol><p>Let&#x27;s look at both of these steps more closely.</p><ul><li>Resolving <code class="language-text">@client</code> data with the help of local resolvers (step 1 above) is explained in <a href="#handling-client-fields-with-resolvers">Handling <code class="language-text">@client</code> fields with resolvers</a>.</li><li>Loading <code class="language-text">@client</code> data from the cache (step 2 above) is explained in <a href="#handling-client-fields-with-the-cache">Handling <code class="language-text">@client</code> fields with the cache</a>.</li></ul><h3 id="handling-client-fields-with-resolvers"><a href="#handling-client-fields-with-resolvers" aria-label="handling client fields with resolvers permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Handling <code class="language-text">@client</code> fields with resolvers</h3><p>Local resolvers are very similar to remote resolvers. Instead of sending your GraphQL query to a remote GraphQL endpoint, which then runs resolver functions against your query to populate and return a result set, Apollo Client runs locally defined resolver functions against any fields marked with the <code class="language-text">@client</code> directive. Let&#x27;s look at an example:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">GET_CART_ITEMS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query GetCartItems {
    cartItems @client
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    cartItems<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Launch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">isInCart</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">launch<span class="token punctuation">,</span> _args<span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> cartItems <span class="token punctuation">}</span> <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">readQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token punctuation">:</span> <span class="token constant">GET_CART_ITEMS</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cartItems<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>launch<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">GET_LAUNCH_DETAILS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query LaunchDetails($launchId: ID!) {
    launch(id: $launchId) {
      isInCart @client
      site
      rocket {
        type
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// ... run the query using client.query, a &lt;Query /&gt; component, etc.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>Here when the <code class="language-text">GET_LAUNCH_DETAILS</code> query is executed, Apollo Client looks for a local resolver associated with the <code class="language-text">isInCart</code> field. Since we&#x27;ve defined a local resolver for the <code class="language-text">isInCart</code> field in the <code class="language-text">ApolloClient</code> constructor, it finds a resolver it can use. This resolver function is run, then the result is calculated and merged in with the rest of the query result (if a local resolver can&#x27;t be found, Apollo Client will check the cache for a matching field - see <a href="#local-data-query-flow">Local data query flow</a> for more details).</p><p>Setting resolvers through <code class="language-text">ApolloClient</code>&#x27;s constructor <code class="language-text">resolvers</code> parameter, or through its <code class="language-text">setResolvers</code> / <code class="language-text">addResolvers</code> methods, adds resolvers to Apollo Client&#x27;s internal resolver map (refer to the <a href="#local-resolvers">Local resolvers</a> section for more details concerning the resolver map). In the above example we added a  <code class="language-text">isInCart</code> resolver, for the <code class="language-text">Launch</code> GraphQL object type, to the resolver map. Let&#x27;s look at the <code class="language-text">isInCart</code> resolver function more closely:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js">  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Launch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">isInCart</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">launch<span class="token punctuation">,</span> _args<span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> cartItems <span class="token punctuation">}</span> <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">readQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token punctuation">:</span> <span class="token constant">GET_CART_ITEMS</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cartItems<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>launch<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p><code class="language-text">launch</code> holds the data returned from the server for the rest of the query, which means in this case we can use <code class="language-text">launch</code> to get the current launch <code class="language-text">id</code>. We aren&#x27;t using any arguments in this resolver, so we can skip the second resolver parameter. From the <code class="language-text">context</code> however (the third parameter), we&#x27;re using the <code class="language-text">cache</code> reference, to work directly with the cache ourselves. So in this resolver, we&#x27;re making a call directly to the cache to get all cart items, checking to see if any of those loaded cart items matches the parent  <code class="language-text">launch.id</code>, and returning <code class="language-text">true</code> / <code class="language-text">false</code> accordingly. The returned boolean is then incorporated back into the result of running the original query.</p><p>Just like resolvers on the server, local resolvers are extremely flexible. They can be used to perform any kind of local computation you want, before returning a result for the specified field. You can manually query (or write to) the cache in different ways, call other helper utilities or libraries to prep/validate/clean data, track statistics, call into other data stores to prep a result, etc.</p><h4 id="integrating-client-into-remote-queries"><a href="#integrating-client-into-remote-queries" aria-label="integrating client into remote queries permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integrating <code class="language-text">@client</code> into remote queries</h4><p>While Apollo Client’s local state handling features can be used to work with local state exclusively, most Apollo based applications are built to work with remote data sources. To address this, Apollo Client supports mixing <code class="language-text">@client</code> based local resolvers with remote queries, as well as using <code class="language-text">@client</code> based fields as arguments to remote queries, in the same request.</p><p>The <code class="language-text">@client</code> directive can be used on any GraphQL selection set or field, to identify that the result of that field should be loaded locally with the help of a local resolver:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">MEMBER_DETAILS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query Member {
    member {
      name
      role
      isLoggedIn @client
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Member<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">isLoggedIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">someInternalLoginVerificationFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... run the query using client.query, the &lt;Query /&gt; component, etc.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>When the above <code class="language-text">MEMBER_DETAILS</code> query is fired by Apollo Client (assuming we&#x27;re talking to a network based GraphQL API), the <code class="language-text">@client</code> <code class="language-text">isLoggedIn</code> field is first stripped from the document, and the remaining query is sent over the network to the GraphQL API. After the query has been handled by the remote resolvers and the result is passed back to Apollo Client from the API, the <code class="language-text">@client</code> parts of the original query are then run against any defined local resolvers, their results are merged with the network results, and the final resulting data is returned as the response to the original operation. So in the above example, <code class="language-text">isLoggedIn</code> is stripped before the rest of the query is sent and handled by the network API, then when the results come back <code class="language-text">isLoggedIn</code> is calculated by running the <code class="language-text">isLoggedIn()</code> function from the resolver map. Local and network results are merged together, and the final response is made available to the application.</p><p>The <code class="language-text">@client</code> directive can be used with entire selection sets as well:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">MEMBER_DETAILS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query Member {
    member {
      name
      role
      session @client {
        isLoggedIn
        connectionCount
        errors
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Member<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          __typename<span class="token punctuation">:</span> <span class="token string">&#x27;Session&#x27;</span><span class="token punctuation">,</span>
          isLoggedIn<span class="token punctuation">:</span> <span class="token function">someInternalLoginVerificationFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          connectionCount<span class="token punctuation">:</span> <span class="token function">calculateOpenConnections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          errors<span class="token punctuation">:</span> <span class="token function">sessionError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>Apollo Client supports the merging of local <code class="language-text">@client</code> results and remote results for Queries, Mutations and Subscriptions.</p><h4 id="async-local-resolvers"><a href="#async-local-resolvers" aria-label="async local resolvers permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Async local resolvers</h4><p>Apollo Client supports asynchronous local resolver functions. These functions can either be <code class="language-text">async</code> functions or ordinary functions that return a <code class="language-text">Promise</code>. Asynchronous resolvers are useful when they need to return data from an asynchronous API.</p><blockquote><p>⚠️ If you would like to hit a REST endpoint from your resolver, <a href="https://github.com/apollographql/apollo-link-rest" target="_blank" rel="noopener noreferrer">we recommend checking out <code class="language-text">apollo-link-rest</code></a> instead, which is a more complete solution for using REST endpoints with Apollo Client.</p></blockquote><p>For React Native and most browser APIs, you should set up a listener in a component lifecycle method and pass in your mutation trigger function as the callback instead of using an async resolver. However, an <code class="language-text">async</code> resolver function is often the most convenient way to consume asynchronous device APIs:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CameraRoll <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;react-native&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">async</span> <span class="token function">cameraRoll</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> assetType <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> media <span class="token operator">=</span> <span class="token keyword">await</span> CameraRoll<span class="token punctuation">.</span><span class="token function">getPhotos</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            first<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
            assetType<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>media<span class="token punctuation">,</span>
            id<span class="token punctuation">:</span> assetType<span class="token punctuation">,</span>
            __typename<span class="token punctuation">:</span> <span class="token string">&#x27;CameraRoll&#x27;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p><a href="https://facebook.github.io/react-native/docs/cameraroll.html#getphotos" target="_blank" rel="noopener noreferrer"><code class="language-text">CameraRoll.getPhotos()</code></a> returns a <code class="language-text">Promise</code> resolving to an object with a <code class="language-text">edges</code> property, which is an array of camera node objects, and a <code class="language-text">page_info</code> property, which is an object with pagination information. This is a great use case for GraphQL, since we can filter down the return value to only the data that our components consume.</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">GET_PHOTOS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query getPhotos($assetType: String!) {
    cameraRoll(assetType: $assetType) @client {
      id
      edges {
        node {
          image {
            uri
          }
          location {
            latitude
            longitude
          }
        }
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><h3 id="handling-client-fields-with-the-cache"><a href="#handling-client-fields-with-the-cache" aria-label="handling client fields with the cache permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Handling <code class="language-text">@client</code> fields with the cache</h3><p>As outlined in <a href="#handling-client-fields-with-resolvers">Handling <code class="language-text">@client</code> fields with resolvers</a>, <code class="language-text">@client</code> fields can be resolved with the help of local resolver functions. However, it&#x27;s important to note that local resolvers are not always required when using an <code class="language-text">@client</code> directive. Fields marked with <code class="language-text">@client</code> can still be resolved locally, by pulling matching values out of the cache directly. For example:</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="jsx"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  ApolloClient<span class="token punctuation">,</span>
  InMemoryCache<span class="token punctuation">,</span>
  HttpLink<span class="token punctuation">,</span>
  ApolloProvider<span class="token punctuation">,</span>
  useQuery<span class="token punctuation">,</span>
  gql
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Pages <span class="token keyword">from</span> <span class="token string">&quot;./pages&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Login <span class="token keyword">from</span> <span class="token string">&quot;./pages/login&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&quot;http://localhost:4000/graphql&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    isLoggedIn<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token operator">!</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">IS_LOGGED_IN</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query IsUserLoggedIn {
    isLoggedIn @client
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">IS_LOGGED_IN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> data<span class="token punctuation">.</span>isLoggedIn <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Pages</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Login</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ApolloProvider</span></span> <span class="token attr-name">client</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>client<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ApolloProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>In the above example, we first prep the cache using <code class="language-text">cache.writeData</code> to store a value for the <code class="language-text">isLoggedIn</code> field. We then run the <code class="language-text">IS_LOGGED_IN</code> query via an Apollo Client <code class="language-text">useQuery</code> hook, which includes an <code class="language-text">@client</code> directive. When Apollo Client executes the <code class="language-text">IS_LOGGED_IN</code> query, it first looks for a local resolver that can be used to handle the <code class="language-text">@client</code> field. When it can&#x27;t find one, it falls back on trying to pull the specified field out of the cache. So in this case, the <code class="language-text">data</code> value returned by the <code class="language-text">useQuery</code> hook has a <code class="language-text">isLoggedIn</code> property available, which includes the <code class="language-text">isLoggedIn</code> result (<code class="language-text">!!localStorage.getItem(&#x27;token&#x27;)</code>) pulled directly from the cache.</p><blockquote><p>⚠️ If you want to use Apollo Client&#x27;s <code class="language-text">@client</code> support to query the cache without using local resolvers, you must pass an empty object into the <code class="language-text">ApolloClient</code> constructor <code class="language-text">resolvers</code> option. Without this Apollo Client will not enable its integrated <code class="language-text">@client</code> support, which means your <code class="language-text">@client</code> based queries will be passed to the Apollo Client link chain. You can find more details about why this is necessary <a href="https://github.com/apollographql/apollo-client/pull/4499" target="_blank" rel="noopener noreferrer">here</a>.</p></blockquote><p>Pulling <code class="language-text">@client</code> field values directly out of the cache isn&#x27;t quite as flexible as local resolver functions, since local resolvers can perform extra computations before returning a result. Depending on your application&#x27;s needs however, loading <code class="language-text">@client</code> fields directly from the cache might be a simpler option. Apollo Client doesn&#x27;t restrict combining both approaches, so feel free to mix and match. If the need arises, you can pull some <code class="language-text">@client</code> values from the cache, and resolve others with local resolvers, all in the same query.</p><h3 id="working-with-fetch-policies"><a href="#working-with-fetch-policies" aria-label="working with fetch policies permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Working with fetch policies</h3><p>Before Apollo Client executes a query, one of the first things it does is check to see which <a href="/apollo-client/v3.0-beta/api/core/#apolloclient-functions"><code class="language-text">fetchPolicy</code></a> it has been configured to use. It does this so it knows where it should attempt to resolve the query from first, either the cache or the network. When running a query, Apollo Client treats <code class="language-text">@client</code> based local resolvers just like it does remote resolvers, in that it will adhere to its defined <code class="language-text">fetchPolicy</code> to know where to attempt to pull data from first. When working with local resolvers, it&#x27;s important to understand how fetch policies impact the running of resolver functions, since by default local resolver functions are not run on every request. This is because the result of running a local resolver is cached with the rest of the query result, and pulled from the cache on the next request. Let&#x27;s look at an example:</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="jsx"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Fragment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useQuery<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Loading<span class="token punctuation">,</span> Header<span class="token punctuation">,</span> LaunchDetail <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../components&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ActionButton <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../containers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">GET_LAUNCH_DETAILS</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query LaunchDetails($launchId: ID!) {
    launch(id: $launchId) {
      isInCart @client
      site
      rocket {
        type
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Launch</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> launchId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> error<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span>
    <span class="token constant">GET_LAUNCH_DETAILS</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> variables<span class="token punctuation">:</span> <span class="token punctuation">{</span> launchId <span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Loading</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ERROR: </span><span class="token punctuation">{</span>error<span class="token punctuation">.</span>message<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Header</span></span> <span class="token attr-name">image</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>launch<span class="token punctuation">.</span>mission<span class="token punctuation">.</span>missionPatch<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>launch<span class="token punctuation">.</span>mission<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Header</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">LaunchDetail</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">data</span><span class="token punctuation">.</span><span class="token attr-value">launch</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ActionButton</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">data</span><span class="token punctuation">.</span><span class="token attr-value">launch</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Fragment</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>In the above example we&#x27;re using an Apollo Client <code class="language-text">useQuery</code> hook to run the <code class="language-text">GET_LAUNCH_DETAILS</code> query. The <code class="language-text">@client</code> based <code class="language-text">isInCart</code> field is configured to pull its data from the following resolver:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">GET_CART_ITEMS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;./pages/cart&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> resolvers <span class="token operator">=</span> <span class="token punctuation">{</span>
  Launch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">isInCart</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">launch<span class="token punctuation">,</span> _<span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> cartItems <span class="token punctuation">}</span> <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">readQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token punctuation">:</span> <span class="token constant">GET_CART_ITEMS</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> cartItems<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>launch<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>Let&#x27;s assume we&#x27;re starting with an empty cache. Since we haven&#x27;t specified a <code class="language-text">fetchPolicy</code> prop in our <code class="language-text">useQuery</code> call, we&#x27;re using Apollo Client&#x27;s default <code class="language-text">cache-first</code> <code class="language-text">fetchPolicy</code>. This means when the <code class="language-text">GET_LAUNCH_DETAILS</code> query is run, it checks the cache first to see if it can find a result. It&#x27;s important to note that when the cache is checked the entire query is run against the cache, but any <code class="language-text">@client</code> associated local resolvers are skipped (not run). So the cache is queried with the following (it&#x27;s as if the <code class="language-text">@client</code> directive was never specified):</p><div class="gatsby-highlight" data-language="graphql"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-graphql line-numbers"><code class="language-graphql">launch<span class="token punctuation">(</span><span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token variable">$launchId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isInCart
  site
  rocket <span class="token punctuation">{</span>
    <span class="token keyword">type</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>In this case a result can&#x27;t be extracted from the cache (since our cache is empty), so behind the scenes Apollo Client moves further down the query execution path. At its next step, it essentially splits the original query into two parts - the part that has <code class="language-text">@client</code> fields and the part that will be fired over the network. Both parts are then executed - results are fetched from the network, and results are calculated by running local resolvers. The results from the local resolvers and from the network are then merged together, and the final result is written to the cache and returned. So after our first run, we now have a result in the cache for the original query, that includes data for both the <code class="language-text">@client</code> parts and network parts of the query.</p><p>When the <code class="language-text">GET_LAUNCH_DETAILS</code> query is run a second time, again since we&#x27;re using Apollo Client&#x27;s default <code class="language-text">fetchPolicy</code> of <code class="language-text">cache-first</code>, the cache is checked first for a result. This time a full result can be found for the query, so that result is returned through our <code class="language-text">useQuery</code> call. Our <code class="language-text">@client</code> field local resolvers aren&#x27;t fired since the result we&#x27;re looking for can already be extracted from the cache.</p><p>In a lot of situations treating local resolvers just like remote resolvers, by having them adhere to the same <code class="language-text">fetchPolicy</code>, makes a lot of sense. Once you have the data you&#x27;re looking for, which might have been fetched remotely or calculated using a local resolver, you can cache it and avoid recalculating/re-fetching it again on a subsequent request. But what if you&#x27;re using local resolvers to run calculations that you need fired on every request? There are a few different ways this can be handled. You can switch your query to use a <code class="language-text">fetchPolicy</code> that forces your entire query to run on each request, like <code class="language-text">no-cache</code> or <code class="language-text">network-only</code>. This will make sure your local resolvers fire on every request, but it will also make sure your network based query components fire on every request. Depending on your use case this might be okay, but what if you want the network parts of your query to leverage the cache, and just want your <code class="language-text">@client</code> parts to run on every request? We&#x27;ll cover a more flexible option for this in the <a href="#forcing-resolvers-with-clientalways-true">Forcing resolvers with <code class="language-text">@client(always: true)</code></a> section.</p><h3 id="forcing-resolvers-with-clientalways-true"><a href="#forcing-resolvers-with-clientalways-true" aria-label="forcing resolvers with clientalways true permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Forcing resolvers with <code class="language-text">@client(always: true)</code></h3><p>Apollo Client leverages its cache to help reduce the network overhead required when constantly making requests for the same data. By default, <code class="language-text">@client</code> based fields leverage the cache in the exact same manner as remote fields. After a local resolver is run, its result is cached alongside any remote results. This way the next time a query is fired that can find its results in the cache, those results are used, and any associated local resolvers are not fired again (until the data is either removed from the cache or the query is updated to use a <code class="language-text">no-cache</code> or <code class="language-text">network-only</code> <code class="language-text">fetchPolicy</code>).</p><p>While leveraging the cache for both local and remote results can be super helpful in a lot of cases, it&#x27;s not always the best fit. We might want to use a local resolver to calculate a dynamic value that needs to be refreshed on every request, while at the same time continue to use the cache for the network based parts of our query. To support this use case, Apollo Client&#x27;s <code class="language-text">@client</code> directive accepts an <code class="language-text">always</code> argument, that when set to <code class="language-text">true</code> will ensure that the associated local resolver is run on every request. Looking at an example:</p><div class="gatsby-highlight" data-language="jsx"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">isLoggedIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#x27;token&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">IS_LOGGED_IN</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query IsUserLoggedIn {
    isLoggedIn @client(always: true)
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// ... run the query using client.query, a &lt;Query /&gt; component, etc.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>The <code class="language-text">isLoggedIn</code> resolver above is checking to see if an authentication token exists in <code class="language-text">localStorage</code>. In this example, we want to make sure that every time the <code class="language-text">IS_LOGGED_IN</code> query is executed, the <code class="language-text">isLoggedIn</code> local resolver is also fired, so that we have the most up to date login information. To do this, we&#x27;re using a <code class="language-text">@client(always: true)</code> directive in the query, for the <code class="language-text">isLoggedIn</code> field. If we didn&#x27;t include <code class="language-text">always: true</code>, then the local resolver would fire based on the queries <code class="language-text">fetchPolicy</code>, which means we could be getting back a cached value for <code class="language-text">isLoggedIn</code>. Using <code class="language-text">@client(always: true)</code> ensures that we&#x27;re always getting the direct result of running the associated local resolver.</p><blockquote><p>⚠️ Please consider the impact of using <code class="language-text">@client(always: true)</code> carefully. While forcing a local resolver to run on every request can be useful, if that resolver is computationally expensive or has side effects, you could be negatively impacting your application. We recommend leveraging the cache as much as possible when using local resolvers, to help with application performance. <code class="language-text">@client(always: true)</code> is helpful to have in your tool-belt, but letting local resolvers adhere to a query <code class="language-text">fetchPolicy</code> should be the preferred choice.</p></blockquote><p>While <code class="language-text">@client(always: true)</code> ensures that a local resolver is always fired, it&#x27;s important to note that if a query is using a <code class="language-text">fetchPolicy</code> that leverages the cache first (<code class="language-text">cache-first</code>, <code class="language-text">cache-and-network</code>, <code class="language-text">cache-only</code>), the query is still attempted to be resolved from the cache first, before the local resolver is fired.    This happens because <code class="language-text">@client(always: true)</code> use could be mixed with normal <code class="language-text">@client</code> use in the same query, which means we want part of the query to adhere to the defined <code class="language-text">fetchPolicy</code>. The benefit of this is that anything that can be loaded from the cache first is made available to your <code class="language-text">@client(always: true)</code> resolver function, as its <a href="#local-resolvers">first parameter</a>. So even though you&#x27;ve used <code class="language-text">@client(always: true)</code> to identify that you want to always run a specific resolver, within that resolver you can look at the loaded cache values for the query, and decide if you want to proceed with running the resolver.</p><h3 id="using-client-fields-as-variables"><a href="#using-client-fields-as-variables" aria-label="using client fields as variables permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using <code class="language-text">@client</code> fields as variables</h3><p>Apollo Client provides a way to use an <code class="language-text">@client</code> field result as a variable for a selection set or field, in the same operation. So instead of running an <code class="language-text">@client</code> based query first, getting the local result, then running a second query using the loaded local result as a variable, everything can be handled in one request. This is achieved by combining the <code class="language-text">@client</code> directive with the <code class="language-text">@export(as: &quot;variableName&quot;)</code> directive:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query currentAuthorPostCount($authorId: Int!) {
    currentAuthorId @client @export(as: &quot;authorId&quot;)
    postCount(authorId: $authorId)
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cache<span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    currentAuthorId<span class="token punctuation">:</span> <span class="token number">12345</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... run the query using client.query, the &lt;Query /&gt; component, etc.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>In the example above, <code class="language-text">currentAuthorId</code> is first loaded from the cache, then passed into the subsequent  <code class="language-text">postCount</code> field as the <code class="language-text">authorId</code> variable (specified by the <code class="language-text">@export(as: &quot;authorId&quot;)</code> directive). The <code class="language-text">@export</code> directive can also be used on specific fields within a selection set, like:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query currentAuthorPostCount($authorId: Int!) {
    currentAuthor @client {
      name
      authorId @export(as: &quot;authorId&quot;)
    }
    postCount(authorId: $authorId)
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  cache<span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    currentAuthor<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      __typename<span class="token punctuation">:</span> <span class="token string">&#x27;Author&#x27;</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token string">&#x27;John Smith&#x27;</span><span class="token punctuation">,</span>
      authorId<span class="token punctuation">:</span> <span class="token number">12345</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... run the query using client.query, the &lt;Query /&gt; component, etc.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>Here the <code class="language-text">authorId</code> variable is set from the <code class="language-text">authorId</code> field loaded from the cache stored <code class="language-text">currentAuthor</code>. <code class="language-text">@export</code> variable use isn&#x27;t limited to remote queries; it can also be used to define variables for other <code class="language-text">@client</code> fields or selection sets:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query currentAuthorPostCount($authorId: Int!) {
    currentAuthorId @client @export(as: &quot;authorId&quot;)
    postCount(authorId: $authorId) @client
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">postCount</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> authorId <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> authorId <span class="token operator">===</span> <span class="token number">12345</span> <span class="token operator">?</span> <span class="token number">100</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    currentAuthorId<span class="token punctuation">:</span> <span class="token number">12345</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ... run the query using client.query, the &lt;Query /&gt; component, etc.</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>So here the <code class="language-text">currentAuthorId</code> is loaded from the cache, then passed into the <code class="language-text">postCount</code> local resolver as <code class="language-text">authorId</code>.</p><p><strong>A few important notes about <code class="language-text">@export</code> use:</strong></p><ol><li><p>Apollo Client currently only supports using the <code class="language-text">@export</code> directive to store variables for local data. <code class="language-text">@export</code> must be used with <code class="language-text">@client</code>.</p></li><li><p><code class="language-text">@client @export</code> use might appear to go against the GraphQL specification, given that the execution order of an operation looks like it could affect the result. From the <a href="https://graphql.github.io/graphql-spec/draft/#sec-Normal-and-Serial-Execution" target="_blank" rel="noopener noreferrer">Normal and Serial Execution</a> section of the GraphQL spec:</p><blockquote><p>... the resolution of fields other than top‐level mutation fields must always be side effect‐free and idempotent, the execution order must not affect the result, and hence the server has the freedom to execute the field entries in whatever order it deems optimal.</p></blockquote><p>Apollo Client currently only supports the use of the <code class="language-text">@export</code> directive when mixed with the <code class="language-text">@client</code> directive. It prepares <code class="language-text">@export</code> variables by first running through an operation that has <code class="language-text">@client @export</code> directives, extracting the specified <code class="language-text">@export</code> variables, then attempting to resolve the value of those variables from the local cache or local resolvers. Once a map of variable names to local values is built up, that map is then used to populate the variables passed in when running the server based GraphQL query. The execution order of the server based GraphQL query is not impacted by <code class="language-text">@export</code> use; the variables are prepped and organized before the server query runs, so the specification is being followed.</p></li><li><p>If you define multiple <code class="language-text">@export</code> variables that use the same name, in a single operation, the value of the last <code class="language-text">@export</code> variable will be used as the variable value moving forward. When this happens Apollo Client will log a warning message (dev only).</p></li></ol><h2 id="managing-the-cache"><a href="#managing-the-cache" aria-label="managing the cache permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Managing the cache</h2><p>When you&#x27;re using Apollo Client to work with local state, your Apollo cache becomes the single source of truth for all of your local and remote data. The <a href="/apollo-client/v3.0-beta/caching/cache-interaction/">Apollo cache API</a> has several methods that can assist you with updating and retrieving data. Let&#x27;s walk through the most relevant methods, and explore some common use cases for each one.</p><h3 id="writedata"><a href="#writedata" aria-label="writedata permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>writeData</h3><p>The easiest way to update the cache is with <code class="language-text">cache.writeData</code>, which allows you to write data directly to the cache without passing in a query. Here&#x27;s how you use it in your resolver map for a simple update:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Mutation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">updateVisibilityFilter</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> visibilityFilter <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> visibilityFilter<span class="token punctuation">,</span> __typename<span class="token punctuation">:</span> <span class="token string">&#x27;Filter&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p><code class="language-text">cache.writeData</code> also allows you to pass in an optional <code class="language-text">id</code> property to write a fragment to an existing object in the cache. This is useful if you want to add some client-side fields to an existing object in the cache.</p><p>The <code class="language-text">id</code> should correspond to the object&#x27;s cache key. If you&#x27;re using the <code class="language-text">InMemoryCache</code> and not overriding the <code class="language-text">dataObjectFromId</code> config property, your cache key should be <code class="language-text">__typename:id</code>.</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Mutation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">updateUserEmail</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> email <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> email <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">User:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p><code class="language-text">cache.writeData</code> should cover most of your needs; however, there are some cases where the data you&#x27;re writing to the cache depends on the data that&#x27;s already there. In that scenario, you should use <code class="language-text">readQuery</code> or <code class="language-text">readFragment</code>, which allows you to pass in a query or a fragment to read data from the cache. If you&#x27;d like to validate the shape of your data that you&#x27;re writing to the cache, use <code class="language-text">writeQuery</code> or <code class="language-text">writeFragment</code>. We&#x27;ll explain some of those use cases below.</p><h3 id="writequery-and-readquery"><a href="#writequery-and-readquery" aria-label="writequery and readquery permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>writeQuery and readQuery</h3><p>Sometimes, the data you&#x27;re writing to the cache depends on data that&#x27;s already in the cache; for example, you&#x27;re adding an item to a list or setting a property based on an existing property value. In that case, you should use <code class="language-text">cache.readQuery</code> to pass in a query and read a value from the cache before you write any data. Let&#x27;s look at an example where we add a todo to a list:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> nextTodoId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    todos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Mutation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">addTodo</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> <span class="token punctuation">{</span> text <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> query <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
          query GetTodos {
            todos @client {
              id
              text
              completed
            }
          }
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> previous <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">readQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> newTodo <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> nextTodoId<span class="token operator">++</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> __typename<span class="token punctuation">:</span> <span class="token string">&#x27;TodoItem&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
          todos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>previous<span class="token punctuation">.</span>todos<span class="token punctuation">,</span> newTodo<span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// you can also do cache.writeData({ data }) here if you prefer</span>
        cache<span class="token punctuation">.</span><span class="token function">writeQuery</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> newTodo<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>In order to add our todo to the list, we need the todos that are currently in the cache, which is why we call <code class="language-text">cache.readQuery</code> to retrieve them. <code class="language-text">cache.readQuery</code> will throw an error if the data isn&#x27;t in the cache, so we need to provide an initial state. This is why we&#x27;re calling <code class="language-text">cache.writeData</code> with the empty array of todos after creating the <code class="language-text">InMemoryCache</code>.</p><p>To write the data to the cache, you can use either <code class="language-text">cache.writeQuery</code> or <code class="language-text">cache.writeData</code>. The only difference between the two is that <code class="language-text">cache.writeQuery</code> requires that you pass in a query to validate that the shape of the data you&#x27;re writing to the cache is the same as the shape of the data required by the query. Under the hood, <code class="language-text">cache.writeData</code> automatically constructs a query from the <code class="language-text">data</code> object you pass in and calls <code class="language-text">cache.writeQuery</code>.</p><h3 id="writefragment-and-readfragment"><a href="#writefragment-and-readfragment" aria-label="writefragment and readfragment permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>writeFragment and readFragment</h3><p><code class="language-text">cache.readFragment</code> is similar to <code class="language-text">cache.readQuery</code> except you pass in a fragment. This allows for greater flexibility because you can read from any entry in the cache as long as you have its cache key. In contrast, <code class="language-text">cache.readQuery</code> only lets you read from the root of your cache.</p><p>Let&#x27;s go back to our previous todo list example and see how <code class="language-text">cache.readFragment</code> can help us toggle one of our todos as completed.</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    Mutation<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">toggleTodo</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> variables<span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">TodoItem:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>variables<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> fragment <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
          fragment completeTodo on TodoItem {
            completed
          }
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> todo <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">readFragment</span><span class="token punctuation">(</span><span class="token punctuation">{</span> fragment<span class="token punctuation">,</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>todo<span class="token punctuation">,</span> completed<span class="token punctuation">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// you can also do cache.writeData({ data, id }) here if you prefer</span>
        cache<span class="token punctuation">.</span><span class="token function">writeFragment</span><span class="token punctuation">(</span><span class="token punctuation">{</span> fragment<span class="token punctuation">,</span> id<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>In order to toggle our todo, we need the todo and its status from the cache, which is why we call <code class="language-text">cache.readFragment</code> and pass in a fragment to retrieve it. The <code class="language-text">id</code> we&#x27;re passing into <code class="language-text">cache.readFragment</code> refers to its cache key. If you&#x27;re using the <code class="language-text">InMemoryCache</code> and not overriding the <code class="language-text">dataObjectFromId</code> config property, your cache key should be <code class="language-text">__typename:id</code>.</p><p>To write the data to the cache, you can use either <code class="language-text">cache.writeFragment</code> or <code class="language-text">cache.writeData</code>. The only difference between the two is that <code class="language-text">cache.writeFragment</code> requires that you pass in a fragment to validate that the shape of the data you&#x27;re writing to the cache node is the same as the shape of the data required by the fragment. Under the hood, <code class="language-text">cache.writeData</code> automatically constructs a fragment from the <code class="language-text">data</code> object and <code class="language-text">id</code> you pass in and calls <code class="language-text">cache.writeFragment</code>.</p><h2 id="client-side-schema"><a href="#client-side-schema" aria-label="client side schema permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Client-side schema</h2><p>You can optionally set a client-side schema to be used with Apollo Client, through either the <code class="language-text">ApolloClient</code> constructor <code class="language-text">typeDefs</code> parameter, or the local state API <code class="language-text">setTypeDefs</code> method. Your schema should be written in <a href="https://www.apollographql.com/docs/graphql-tools/generate-schema#schema-language">Schema Definition Language</a>. This schema is not used for validation like it is on the server because the <code class="language-text">graphql-js</code> modules for schema validation would dramatically increase your bundle size. Instead, your client-side schema is used for introspection in <a href="https://github.com/apollographql/apollo-client-devtools" target="_blank" rel="noopener noreferrer">Apollo Client Devtools</a>, where you can explore your schema in GraphiQL.</p><p>The following demonstrates how to configure a client-side schema through the <code class="language-text">ApolloClient</code> constructor:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> typeDefs <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  extend type Query {
    isLoggedIn: Boolean!
    cartItems: [Launch]!
  }

  extend type Launch {
    isInCart: Boolean!
  }

  extend type Mutation {
    addOrRemoveFromCart(id: ID!): [Launch]
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  typeDefs<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>If you open up Apollo Client Devtools and click on the <code class="language-text">GraphiQL</code> tab, you&#x27;ll be able to explore your client schema in the &quot;Docs&quot; section. This example doesn&#x27;t include a remote schema, but if it did, you would be able to see your local queries and mutations alongside your remote ones.</p><p><img src="/apollo-client/957e4fa2caa08d3edd5a8efb436e2c24/client-schema.png" alt="GraphiQL Console"/></p><h2 id="advanced"><a href="#advanced" aria-label="advanced permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Advanced</h2><h3 id="code-splitting"><a href="#code-splitting" aria-label="code splitting permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Code splitting</h3><p>Depending on the complexity and size of your local resolvers, you might not always want to define them up front, when you create your initial <code class="language-text">ApolloClient</code> instance. If you have local resolvers that are only needed in a specific part of your application, you can leverage Apollo Client&#x27;s <a href="#methods"><code class="language-text">addResolvers</code> and <code class="language-text">setResolvers</code></a> functions to adjust your resolver map at any point. This can be really useful when leveraging techniques like route based code-splitting, using something like <a href="https://github.com/jamiebuilds/react-loadable" target="_blank" rel="noopener noreferrer"><code class="language-text">react-loadable</code></a>.</p><p>Let&#x27;s say we&#x27;re building a messaging app and have a <code class="language-text">/stats</code> route that is used to return the total number of messages stored locally. If we use <code class="language-text">react-loadable</code> to load our <code class="language-text">Stats</code> component like:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> Loadable <span class="token keyword">from</span> <span class="token string">&#x27;react-loadable&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Loading <span class="token keyword">from</span> <span class="token string">&#x27;./components/Loading&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> Stats <span class="token operator">=</span> <span class="token function">Loadable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">loader</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#x27;./components/stats/Stats&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  loading<span class="token punctuation">:</span> Loading<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>and wait until our <code class="language-text">Stats</code> component is called to define our local resolvers (using <code class="language-text">addResolvers</code>):</p><div class="css-79elbk e1fo8r5c0"><div data-language="Hooks (JavaScript)"><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><div class="e1ulzjg72 css-1mux1e8 e1azhpec0"><button class="css-1pl2i23"><div class="css-dtw560"><div style="height:20px" class="css-79elbk e1azhpec4"><div class="css-gyp8mm e1azhpec5"></div><div class="css-gyp8mm e1azhpec5"></div><div class="css-v0jgcu e1azhpec6"></div></div><svg viewBox="0 0 24 24" class="e1azhpec1 css-xdptra"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M23.25 7.311L12.53 18.03a.749.749 0 0 1-1.059.001l-.001-.001L.75 7.311"></path></svg></div></button></div><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloConsumer<span class="token punctuation">,</span> useApolloClient<span class="token punctuation">,</span> useQuery<span class="token punctuation">,</span> gql <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@apollo/client&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">GET_MESSAGE_COUNT</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  {
    messageCount @client {
      total
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> resolvers <span class="token operator">=</span> <span class="token punctuation">{</span>
  Query<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">messageCount</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> args<span class="token punctuation">,</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ... calculate and return the number of messages in</span>
      <span class="token comment">// the cache ...</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        total<span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
        __typename<span class="token punctuation">:</span> <span class="token string">&quot;MessageCount&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">MessageCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token function">useApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  client<span class="token punctuation">.</span><span class="token function">addResolvers</span><span class="token punctuation">(</span>resolvers<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span> messageCount <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">GET_MESSAGE_COUNT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;Loading ...&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
      Total number <span class="token keyword">of</span> messages<span class="token punctuation">:</span> <span class="token punctuation">{</span>messageCount<span class="token punctuation">.</span>total<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></div></div><p>our local resolver code will only be included in the bundle a user downloads when (if) they access <code class="language-text">/stats</code>. It won&#x27;t be included in the initial application bundle, which helps keep the size of our initial bundle down, and ultimately helps with download and application startup times.</p><h2 id="migrating-from-apollo-link-state"><a href="#migrating-from-apollo-link-state" aria-label="migrating from apollo link state permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Migrating from <code class="language-text">apollo-link-state</code></h2><p>The <a href="https://github.com/apollographql/apollo-link-state" target="_blank" rel="noopener noreferrer"><code class="language-text">apollo-link-state</code></a> project was the first to bring local state handling into the Apollo ecosystem. Handling local resolvers through the addition of an <code class="language-text">ApolloLink</code> was a great starting point, and proved that <code class="language-text">@client</code> based queries make sense, and work really well for local state management.</p><p>While <code class="language-text">apollo-link-state</code> achieved some of the goals of local state handling, the information available when using any <code class="language-text">ApolloLink</code> is limited by the modularity of the link system. We consider local state management a core part of the Apollo ecosystem, and as Apollo Client progresses, we want to make sure local resolvers are integrated as tightly as possible into core. This integration opens up new possibilities (like <code class="language-text">@export</code> handling) and ties nicely into the future planned adjustments to cache data retention, invalidation, garbage collection, and other planned features that impact both local and remote data.</p><p>Updating your application to use Apollo Client&#x27;s local state management features, instead of <code class="language-text">apollo-link-state</code>, is fairly straightforward. The necessary steps are outlined below.</p><ol><li><p>Including <code class="language-text">apollo-link-state</code> as a dependency, and importing it to use <code class="language-text">withClientState</code>, is no longer necessary. You can remove the <code class="language-text">apollo-link-state</code> dependency since local state management is included with <code class="language-text">apollo-client</code> &gt;= 2.5.0 and <code class="language-text">@apollo/client</code> &gt;= 3.0.0.</p></li><li><p>Using <code class="language-text">withClientState</code> is no longer supported. The following:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> stateLink <span class="token operator">=</span> <span class="token function">withClientState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cache<span class="token punctuation">,</span> resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> link <span class="token operator">=</span> ApolloLink<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span>stateLink<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;...&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  link<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>becomes</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;...&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></li><li><p><code class="language-text">defaults</code> are no longer supported. To prep the cache, use <a href="#writedata"><code class="language-text">cache.writeData</code></a> directly instead. So</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> stateLink <span class="token operator">=</span> <span class="token function">withClientState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  defaults<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    someField<span class="token punctuation">:</span> <span class="token string">&#x27;some value&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> link <span class="token operator">=</span> ApolloLink<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span>stateLink<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;...&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  link<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><p>becomes:</p><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">,</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;...&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    someField<span class="token punctuation">:</span> <span class="token string">&#x27;some value&#x27;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div></li><li><p>Test thoroughly! 🙂</p></li></ol><h2 id="next-steps"><a href="#next-steps" aria-label="next steps permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next steps</h2><p>Managing your local data with Apollo Client can help simplify your state management code, since the Apollo cache becomes your single source of truth for all of the data in your application. If you&#x27;d like to learn more about Apollo Client&#x27;s local state features, check out:</p><ul><li>The <a href="https://www.apollographql.com/docs/tutorial/introduction">Apollo tutorial</a> which will not only show you how to use Apollo Client&#x27;s local state features in a step by step manner, but will also guide you through using other Apollo components to build a fullstack application.</li><li>The <a href="https://spectrum.chat/apollo" target="_blank" rel="noopener noreferrer">Apollo community Spectrum group</a> is a great place to ask Apollo Client local state questions.</li><li>Interested in suggesting or working on future changes to help make Apollo Client&#x27;s local state management even better? We&#x27;d love the help! <a href="https://github.com/apollographql/apollo-feature-requests" target="_blank" rel="noopener noreferrer">Open a new feature request</a> to kick start your feature discussion.</li><li>Found a bug? Impossible! 🙈 Open a new issue in the <a href="https://github.com/apollographql/apollo-client" target="_blank" rel="noopener noreferrer">Apollo Client repo</a>, ideally with a small runnable reproduction, and someone from the community or Apollo team will help get it fixed.</li></ul><h2 id="api"><a href="#api" aria-label="api permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API</h2><p>Apollo Client local state handling is baked in, so you don&#x27;t have to install anything extra. Local state management can be configured during <code class="language-text">ApolloClient</code> instantiation (via the <code class="language-text">ApolloClient</code> constructor) or by using the <code class="language-text">ApolloClient</code> local state API. Data in the cache can be managed through the <code class="language-text">ApolloCache</code> API.</p><h3 id="apolloclient"><a href="#apolloclient" aria-label="apolloclient permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ApolloClient</h3><h4 id="constructor"><a href="#constructor" aria-label="constructor permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Constructor</h4><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolvers<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  typeDefs<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><style data-emotion-css="12nk8bc">.css-12nk8bc{overflow:auto;margin-bottom:1.45rem;}</style><div class="css-12nk8bc ernxcdh1"><style data-emotion-css="1qo5u65">.css-1qo5u65{border:1px solid #DEE2E7;border-spacing:0;border-radius:4px;}.css-1qo5u65 th,.css-1qo5u65 td{padding:16px;border-bottom:1px solid #DEE2E7;}.css-1qo5u65 tbody tr:last-child td{border:0;}.css-1qo5u65 th{-webkit-letter-spacing:0.142em;-moz-letter-spacing:0.142em;-ms-letter-spacing:0.142em;letter-spacing:0.142em;text-transform:uppercase;font-size:13px;font-weight:normal;color:#5A6270;text-align:inherit;}.css-1qo5u65 td{vertical-align:top;}.css-1qo5u65 td code{white-space:normal;}</style><table class="css-1qo5u65 ernxcdh2"><thead><tr><th>Option</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="language-text">resolvers?</code></td><td>Resolvers <!-- -->|<!-- --> Resolvers[]</td><td>A map of resolver functions that your GraphQL queries and mutations call in order to read and write to the cache.</td></tr><tr><td><code class="language-text">typeDefs?</code></td><td>string <!-- -->|<!-- --> string[] <!-- -->|<!-- --> DocumentNode <!-- -->|<!-- --> DocumentNode[];<!-- -->&lt;<!-- -->string<!-- -->&gt;</td><td>A string representing your client-side schema written in the <a href="https://www.apollographql.com/docs/graphql-tools/generate-schema#schema-language">Schema Definition Language</a>. This schema is not used for validation, but is used for introspection by the <a href="https://github.com/apollographql/apollo-client-devtools" target="_blank" rel="noopener noreferrer">Apollo Client Devtools</a>.</td></tr></tbody></table></div><p>None of these options are required. If you don&#x27;t specify anything, you will still be able to use the <code class="language-text">@client</code> directive to query the Apollo Client cache.</p><h4 id="methods"><a href="#methods" aria-label="methods permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Methods</h4><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> ApolloClient<span class="token punctuation">,</span> InMemoryCache<span class="token punctuation">,</span> HttpLink <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  cache<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  link<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">HttpLink</span><span class="token punctuation">(</span><span class="token punctuation">{</span> uri<span class="token punctuation">:</span> <span class="token string">&#x27;http://localhost:4000/graphql&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

client<span class="token punctuation">.</span><span class="token function">setResolvers</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><div class="css-12nk8bc ernxcdh1"><table class="css-1qo5u65 ernxcdh2"><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td>addResolvers(resolvers: Resolvers <!-- -->|<!-- --> Resolvers[])</td><td>A map of resolver functions that your GraphQL queries and mutations call in order to read and write to the cache. Resolver functions added through <code class="language-text">addResolvers</code> are added to the internal resolver function map, meaning any existing resolvers (that aren&#x27;t overwritten) are preserved.</td></tr><tr><td>setResolvers(resolvers: Resolvers <!-- -->|<!-- --> Resolvers[])</td><td>A map of resolver functions that your GraphQL queries and mutations call in order to read and write to the cache. Resolver functions added through <code class="language-text">setResolvers</code> overwrite all existing resolvers (a pre-existing resolver map is wiped out, before the new resolvers are added).</td></tr><tr><td><code class="language-text">getResolvers</code></td><td>Get the currently defined resolver map.</td></tr><tr><td><code class="language-text">setLocalStateFragmentMatcher(fragmentMatcher: FragmentMatcher)</code></td><td>Set a custom <code class="language-text">FragmentMatcher</code> to be used when resolving local state queries involving <a href="/apollo-client/v3.0-beta/data/fragments/#using-fragments-with-unions-and-interfaces">fragments on unions or interfaces</a>.</td></tr></tbody></table></div><p><strong>Typescript interfaces/types:</strong></p><div class="gatsby-highlight" data-language="ts"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-ts line-numbers"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">Resolvers</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>key<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>field<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>
      <span class="token parameter">rootValue<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
      args<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
      context<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
      info<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span></span>
    <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token function-variable function">FragmentMatcher</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token parameter">rootValue<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  typeCondition<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  context<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span></span>
<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><h3 id="apollocache"><a href="#apollocache" aria-label="apollocache permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ApolloCache</h3><h4 id="methods-1"><a href="#methods-1" aria-label="methods 1 permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Methods</h4><div class="gatsby-highlight" data-language="js"><div class="css-1gcd36t e1ulzjg70"><div class="css-j1ow3a e1ulzjg71"><button class="css-1pl2i23"><div class="css-dtw560">Copy</div></button></div><div class="css-r8v8pb e1ulzjg73"><pre class="language-js line-numbers"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> InMemoryCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;@apollo/client&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InMemoryCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">writeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    isLoggedIn<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token operator">!</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#x27;token&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    cartItems<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space:normal;width:auto;left:0"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div></div><div class="css-12nk8bc ernxcdh1"><table class="css-1qo5u65 ernxcdh2"><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td><code class="language-text">writeData({ idundefined data })</code></td><td>Write data directly to the root of the cache without having to pass in a query. Great for prepping the cache with initial data. If you would like to write data to an existing entry in the cache, pass in the entry&#x27;s cache key to <code class="language-text">id</code>.</td></tr><tr><td><code class="language-text">writeQuery({ queryundefined variablesundefined data })</code></td><td>Similar to <code class="language-text">writeData</code> (writes data to the root of the cache) but uses the specified query to validate that the shape of the data you’re writing to the cache is the same as the shape of the data required by the query.</td></tr><tr><td><code class="language-text">readQuery({ queryundefined variables })</code></td><td>Read data from the cache for the specified query.</td></tr><tr><td><code class="language-text">writeFragment({ idundefined fragmentundefined fragmentNameundefined variablesundefined data })</code></td><td>Similar to <code class="language-text">writeData</code> (writes data to an existing entry in the cache) but uses the specified fragment to validate that the shape of the data you’re writing to the cache is the same as the shape of the data required by the fragment.</td></tr><tr><td><code class="language-text">readFragment({ idundefined fragmentundefined fragmentNameundefined variables })</code></td><td>Read data from the cache for the specified fragment.</td></tr></tbody></table></div></div><style data-emotion-css="1f6gfyy">.css-1f6gfyy{display:none;margin-top:48px;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}@media (max-width:1120px){.css-1f6gfyy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}@media (max-width:850px){.css-1f6gfyy{display:none;}}@media (max-width:600px){.css-1f6gfyy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-top:24px;}}</style><div class="css-1f6gfyy e694h6z7"><style data-emotion-css="rntvij">.css-rntvij{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:0;}.css-rntvij:not(:last-child){margin-bottom:16px;}</style><h5 class="css-rntvij e694h6z5"><style data-emotion-css="rq9thv">.css-rq9thv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#5A6270;-webkit-text-decoration:none;text-decoration:none;}.css-rq9thv:hover{color:#959DAA;}.css-rq9thv svg{width:20px;height:20px;margin-right:6px;fill:currentColor;}</style><a target="_blank" rel="noopener noreferrer" href="https://github.com/apollographql/apollo-client/tree/master/docs/source/docs/source/data/local-state.mdx" class="css-rq9thv e694h6z6"><style data-emotion-css="12oh1jh">.css-12oh1jh{overflow:visible;height:26px;}.css-12oh1jh *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 26 26" class="css-12oh1jh"><g fill="none" fill-rule="evenodd" transform="translate(1 1)"><path fill="currentColor" fill-rule="nonzero" d="M15.425 22.985V20.95c0-1.081-.371-1.876-1.112-2.385.465-.045.891-.107 1.279-.188a9.967 9.967 0 0 0 1.233-.348 6.039 6.039 0 0 0 1.166-.543c.344-.21.674-.482.991-.817.317-.335.583-.715.797-1.139.215-.424.384-.933.509-1.527a9.543 9.543 0 0 0 .188-1.963c0-1.384-.451-2.563-1.353-3.537.411-1.072.366-2.237-.134-3.497l-.335-.04c-.232-.027-.65.071-1.253.295-.603.224-1.279.589-2.03 1.098a12.317 12.317 0 0 0-3.309-.442c-1.152 0-2.251.147-3.296.442a11.41 11.41 0 0 0-1.346-.797 6.948 6.948 0 0 0-1.018-.429 3.503 3.503 0 0 0-1.132-.154.844.844 0 0 0-.134.027c-.5 1.268-.545 2.434-.134 3.497-.902.973-1.353 2.152-1.353 3.537 0 .715.063 1.369.188 1.963.125.594.295 1.103.509 1.527.214.424.48.804.797 1.139.317.335.647.607.991.817.344.21.732.391 1.166.543a9.54 9.54 0 0 0 1.233.348c.389.08.815.143 1.279.188-.732.5-1.098 1.295-1.098 2.385v2.075C10.5 24 14 24 15.425 22.985z"></path><circle cx="12" cy="12" r="12" stroke="currentColor" stroke-width="1.5"></circle></g></svg> Edit on GitHub</a></h5></div><style data-emotion-css="9ckfit">.css-9ckfit{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:64px 0;}@media (max-width:850px){.css-9ckfit{padding:32px 0;}}</style><nav class="css-9ckfit e1sfxy7w0"><style data-emotion-css="spe9v1">.css-spe9v1{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-spe9v1 svg{height:16px;width:16px;}.css-spe9v1:hover{opacity:0.8;}</style><a class="css-spe9v1 e1sfxy7w1" href="/apollo-client/v3.0-beta/data/mutations/"><svg viewBox="0 0 14 24" class="css-10zhkrl"><path fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12.5.75L1.78 11.47a.749.749 0 0 0-.001 1.059l.001.001L12.5 23.25"></path></svg><style data-emotion-css="16mhdhi">.css-16mhdhi{margin-left:24px;text-align:left;}@media (max-width:850px){.css-16mhdhi{margin-left:16px;}}</style><div class="css-16mhdhi e1sfxy7w2"><style data-emotion-css="1vhhq4p">.css-1vhhq4p{-webkit-letter-spacing:0.142em;-moz-letter-spacing:0.142em;-ms-letter-spacing:0.142em;letter-spacing:0.142em;text-transform:uppercase;font-size:12px;}</style><div class="css-1vhhq4p e1sfxy7w3">Previous</div><style data-emotion-css="mtbysh">.css-mtbysh{color:#2F353F;}</style><div class="css-mtbysh e1sfxy7w4">Mutations</div></div></a><a style="margin-left:auto" class="css-spe9v1 e1sfxy7w1" href="/apollo-client/v3.0-beta/data/subscriptions/"><style data-emotion-css="18eg9eb">.css-18eg9eb{margin-right:24px;text-align:right;}@media (max-width:850px){.css-18eg9eb{margin-right:16px;}}</style><div class="css-18eg9eb e1sfxy7w2"><div class="css-1vhhq4p e1sfxy7w3">Next</div><div class="css-mtbysh e1sfxy7w4">Subscriptions</div></div><svg viewBox="0 0 24 24" class="css-10zhkrl"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5.5.75l10.72 10.72a.749.749 0 0 1 .001 1.059l-.001.001L5.5 23.25"></path></svg></a></nav></div><style data-emotion-css="cw47jp">.css-cw47jp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:240px;max-height:calc(100vh - 64px);margin-top:-36px;padding:40px 0;margin-left:40px;position:-webkit-sticky;position:sticky;top:64px;}@media (max-width:1120px){.css-cw47jp{display:none;}}@media (max-width:850px){.css-cw47jp{display:block;}}@media (max-width:600px){.css-cw47jp{display:none;}}</style><aside class="css-cw47jp e694h6z3"><style data-emotion-css="35ezg3">.css-35ezg3{font-weight:600;}</style><h4 class="css-35ezg3 e694h6z4">Local state management</h4><style data-emotion-css="1b603mp">.css-1b603mp{margin-left:0;margin-bottom:48px;overflow:auto;}</style><ul class="css-1b603mp e1wyoreh0"><style data-emotion-css="a8oa9s">.css-a8oa9s{list-style:none;font-size:1rem;line-height:inherit;}.css-a8oa9s a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}.css-a8oa9s a:hover{opacity:0.8;}</style><li class="css-a8oa9s e1wyoreh1"><a href="#updating-local-state">Updating local state</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#querying-local-state">Querying local state</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#managing-the-cache">Managing the cache</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#client-side-schema">Client-side schema</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#advanced">Advanced</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#migrating-from-apollo-link-state">Migrating from apollo-link-state</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#next-steps">Next steps</a></li><li class="css-a8oa9s e1wyoreh1"><a href="#api">API</a></li></ul><h5 class="css-rntvij e694h6z5"><a target="_blank" rel="noopener noreferrer" href="https://github.com/apollographql/apollo-client/tree/master/docs/source/docs/source/data/local-state.mdx" class="css-rq9thv e694h6z6"><svg viewBox="0 0 26 26" class="css-12oh1jh"><g fill="none" fill-rule="evenodd" transform="translate(1 1)"><path fill="currentColor" fill-rule="nonzero" d="M15.425 22.985V20.95c0-1.081-.371-1.876-1.112-2.385.465-.045.891-.107 1.279-.188a9.967 9.967 0 0 0 1.233-.348 6.039 6.039 0 0 0 1.166-.543c.344-.21.674-.482.991-.817.317-.335.583-.715.797-1.139.215-.424.384-.933.509-1.527a9.543 9.543 0 0 0 .188-1.963c0-1.384-.451-2.563-1.353-3.537.411-1.072.366-2.237-.134-3.497l-.335-.04c-.232-.027-.65.071-1.253.295-.603.224-1.279.589-2.03 1.098a12.317 12.317 0 0 0-3.309-.442c-1.152 0-2.251.147-3.296.442a11.41 11.41 0 0 0-1.346-.797 6.948 6.948 0 0 0-1.018-.429 3.503 3.503 0 0 0-1.132-.154.844.844 0 0 0-.134.027c-.5 1.268-.545 2.434-.134 3.497-.902.973-1.353 2.152-1.353 3.537 0 .715.063 1.369.188 1.963.125.594.295 1.103.509 1.527.214.424.48.804.797 1.139.317.335.647.607.991.817.344.21.732.391 1.166.543a9.54 9.54 0 0 0 1.233.348c.389.08.815.143 1.279.188-.732.5-1.098 1.295-1.098 2.385v2.075C10.5 24 14 24 15.425 22.985z"></path><circle cx="12" cy="12" r="12" stroke="currentColor" stroke-width="1.5"></circle></g></svg> Edit on GitHub</a></h5><h5 class="css-rntvij e694h6z5"><a target="_blank" rel="noopener noreferrer" href="https://spectrum.chat/apollo/apollo-client" class="css-rq9thv e694h6z6"><svg viewBox="0 0 32 32"><path d="M4 14.2A1.8 1.8 0 005.8 16h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C28 13.133 18.867 4 7.6 4H5.8A1.8 1.8 0 004 5.8v8.4z"></path></svg> Discuss on Spectrum</a></h5></aside></div></div></main></div><style data-emotion-css="12zcwkl">.css-12zcwkl{width:100%;height:100%;background-color:rgba(90,98,112,0.5);overflow:auto;position:fixed;top:0;left:0;z-index:3;-webkit-perspective:1000px;-moz-perspective:1000px;-ms-perspective:1000px;perspective:1000px;-webkit-transition-property:opacity,visibility;transition-property:opacity,visibility;-webkit-transition-duration:150ms;transition-duration:150ms;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;}</style><div style="opacity:0;visibility:hidden" class="css-12zcwkl em9i7t20"><style data-emotion-css="1fw1ckn">.css-1fw1ckn{width:700px;margin-bottom:24px;border-radius:4px;box-shadow:rgba(0,0,0,0.1) 0 2px 12px;background-color:white;overflow:hidden;position:absolute;-webkit-transform-origin:25% 25%;-ms-transform-origin:25% 25%;transform-origin:25% 25%;-webkit-transition:-webkit-transform 150ms ease-in-out;-webkit-transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out;outline:none;}@media (max-width:850px){.css-1fw1ckn{width:450px;}}@media (max-width:600px){.css-1fw1ckn{width:calc(100vw - 48px);}}</style><div tabindex="-1" style="transform:translate3d(0,-24px,-16px) rotate3d(1,0,0.1,8deg)" class="css-1fw1ckn em9i7t21"><style data-emotion-css="1cxr8k1">.css-1cxr8k1{-webkit-letter-spacing:0.142em;-moz-letter-spacing:0.142em;-ms-letter-spacing:0.142em;letter-spacing:0.142em;text-transform:uppercase;margin:24px;margin-bottom:0;font-size:13px;font-weight:600;color:#959DAA;}</style><h6 class="css-1cxr8k1 em9i7t22">Apollo Platform</h6><style data-emotion-css="iccqi5">.css-iccqi5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:12px;}</style><nav class="css-iccqi5 em9i7t23"><style data-emotion-css="2305o9">.css-2305o9{display:block;width:50%;}@media (max-width:850px){.css-2305o9{width:100%;}}</style><div class="css-2305o9 em9i7t24"><style data-emotion-css="17kd93q">.css-17kd93q{display:block;height:100%;padding:12px;border-radius:4px;color:#2F353F;-webkit-text-decoration:none;text-decoration:none;background-color:transparent;-webkit-transition-property:color,background-color;transition-property:color,background-color;-webkit-transition-duration:150ms;transition-duration:150ms;-webkit-transition-timing-function:ease-in-out;transition-timing-function:ease-in-out;}@media (hover:hover){.css-17kd93q:hover{color:white;background-color:#3f20ba;}.css-17kd93q:hover p{color:#d9cfff;}}</style><a href="https://www.apollographql.com/docs" class="css-17kd93q em9i7t25"><style data-emotion-css="159absb">.css-159absb{margin-bottom:8px;font-weight:600;color:inherit;}</style><h4 class="css-159absb em9i7t26">Apollo Basics</h4><style data-emotion-css="1s3czjc">.css-1s3czjc{margin-bottom:0;font-size:14px;line-height:1.5;color:#959DAA;-webkit-transition:color 150ms ease-in-out;transition:color 150ms ease-in-out;}</style><p class="css-1s3czjc em9i7t27">Learn about each part of the Apollo platform and how they all work together.</p></a></div><div class="css-2305o9 em9i7t24"><a href="https://www.apollographql.com/docs/apollo-server" class="css-17kd93q em9i7t25"><h4 class="css-159absb em9i7t26">Apollo Server</h4><p class="css-1s3czjc em9i7t27">Configure a production-ready GraphQL server to fetch and combine data from multiple sources.</p></a></div><div class="css-2305o9 em9i7t24"><a href="https://www.apollographql.com/docs/react" class="css-17kd93q em9i7t25"><h4 class="css-159absb em9i7t26">Apollo Client (React)</h4><p class="css-1s3czjc em9i7t27">Manage the entirety of your React app&#x27;s state and seamlessly execute GraphQL operations.</p></a></div><div class="css-2305o9 em9i7t24"><a href="https://www.apollographql.com/docs/graph-manager" class="css-17kd93q em9i7t25"><h4 class="css-159absb em9i7t26">Apollo Graph Manager</h4><p class="css-1s3czjc em9i7t27">Integrate with Apollo&#x27;s cloud service for schema versioning, metrics, and enhanced security.</p></a></div><div class="css-2305o9 em9i7t24"><a href="https://www.apollographql.com/docs/ios" class="css-17kd93q em9i7t25"><h4 class="css-159absb em9i7t26">Apollo Client (iOS)</h4><p class="css-1s3czjc em9i7t27">Manage the entirety of your iOS app&#x27;s state and seamlessly execute GraphQL operations.</p></a></div><div class="css-2305o9 em9i7t24"><a href="https://www.apollographql.com/docs/link" class="css-17kd93q em9i7t25"><h4 class="css-159absb em9i7t26">Apollo Link</h4><p class="css-1s3czjc em9i7t27">Define a custom chain of actions that your client performs with each GraphQL operation.</p></a></div></nav><style data-emotion-css="1we5kcv">.css-1we5kcv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px 24px;background-color:#F4F6F8;}@media (max-width:850px){.css-1we5kcv{display:block;}}</style><nav class="css-1we5kcv em9i7t28"><style data-emotion-css="16cjsrx">.css-16cjsrx{color:#5A6270;-webkit-text-decoration:none;text-decoration:none;}.css-16cjsrx:hover{color:#959DAA;}.css-16cjsrx:not(:last-child){margin-right:24px;}</style><a href="https://blog.apollographql.com/" target="_blank" rel="noopener noreferrer" class="css-16cjsrx em9i7t29">Blog</a><a href="https://www.apollographql.com/docs/community/" class="css-16cjsrx em9i7t29">Contribute</a><a href="https://summit.graphql.com/" target="_blank" rel="noopener noreferrer" class="css-16cjsrx em9i7t29">GraphQL Summit</a><style data-emotion-css="gdccfg">.css-gdccfg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-left:auto;}@media (max-width:850px){.css-gdccfg{margin-top:8px;}}</style><div class="css-gdccfg em9i7t210"><style data-emotion-css="1u52uy1">.css-1u52uy1{color:#5A6270;}.css-1u52uy1:hover{color:#959DAA;}.css-1u52uy1:not(:last-child){margin-right:24px;}.css-1u52uy1 svg{height:24px;width:24px;display:block;fill:currentColor;}</style><a href="https://spectrum.chat/apollo" title="Spectrum" target="_blank" class="css-1u52uy1 em9i7t211"><svg viewBox="0 0 32 32"><path d="M4 14.2A1.8 1.8 0 005.8 16h1.8a8.4 8.4 0 018.4 8.4v1.8a1.8 1.8 0 001.8 1.8h8.4a1.8 1.8 0 001.8-1.8v-1.8C28 13.133 18.867 4 7.6 4H5.8A1.8 1.8 0 004 5.8v8.4z"></path></svg></a><a href="https://twitter.com/apollographql" title="Twitter" target="_blank" class="css-1u52uy1 em9i7t211"><style data-emotion-css="10zhkrl">.css-10zhkrl{overflow:visible;height:24px;}.css-10zhkrl *{vector-effect:non-scaling-stroke;}</style><svg viewBox="0 0 24 24" class="css-10zhkrl"><path fill="currentColor" d="M23.32 6.44a.5.5 0 0 0-.2-.87l-.79-.2a.5.5 0 0 1-.33-.7l.44-.89a.501.501 0 0 0-.58-.7l-2 .56a.502.502 0 0 1-.44-.08 5 5 0 0 0-8 4v.36a.25.25 0 0 1-.22.25c-2.81.33-5.5-1.1-8.4-4.44a.508.508 0 0 0-.51-.15A.5.5 0 0 0 2 4a7.575 7.575 0 0 0 .46 4.92.25.25 0 0 1-.26.36l-1.12-.22a.5.5 0 0 0-.57.59 5.15 5.15 0 0 0 2.37 3.78.25.25 0 0 1 0 .45l-.53.21a.5.5 0 0 0-.26.69 4.36 4.36 0 0 0 3.2 2.48.25.25 0 0 1 0 .47c-1.36.562-2.819.845-4.29.83a.51.51 0 0 0-.2 1 20.063 20.063 0 0 0 8.14 1.93 12.58 12.58 0 0 0 7-2A12.5 12.5 0 0 0 21.5 9.06v-.87a.499.499 0 0 1 .18-.38l1.64-1.37z"></path></svg></a><a href="https://www.youtube.com/channel/UC0pEW_GOrMJ23l8QcrGdKSw" title="YouTube" target="_blank" class="css-1u52uy1 em9i7t211"><svg viewBox="0 0 24 24" class="css-10zhkrl"><path fill="currentColor" d="M20.06 3.5H3.94A3.94 3.94 0 0 0 0 7.44v9.12a3.94 3.94 0 0 0 3.94 3.94h16.12A3.94 3.94 0 0 0 24 16.56V7.44a3.94 3.94 0 0 0-3.94-3.94zM16.54 12l-6.77 4.36a.5.5 0 0 1-.77-.42V7.28a.5.5 0 0 1 .77-.42l6.77 4.33a.5.5 0 0 1 0 .84V12z"></path></svg></a></div></nav></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/v3.0-beta/data/local-state/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-30bbb03994201fb9918f.js"],"component---node-modules-gatsby-theme-apollo-docs-src-components-template-js":["/component---node-modules-gatsby-theme-apollo-docs-src-components-template-js-ea9bbb2045f936bba914.js"],"component---node-modules-gatsby-theme-apollo-core-src-pages-404-js":["/component---node-modules-gatsby-theme-apollo-core-src-pages-404-js-ffc2bfe80a170839896a.js"]};/*]]>*/</script><script src="/apollo-client/component---node-modules-gatsby-theme-apollo-docs-src-components-template-js-ea9bbb2045f936bba914.js" async=""></script><script src="/apollo-client/app-30bbb03994201fb9918f.js" async=""></script><script src="/apollo-client/commons-549c24a093027ad17843.js" async=""></script><script src="/apollo-client/styles-2013ea808de36cd95e02.js" async=""></script><script src="/apollo-client/webpack-runtime-db38c7f1b7d41648e3e8.js" async=""></script></body></html>